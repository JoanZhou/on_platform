<!DOCTYPE html>
<html lang="zh-cmn-Hans">

<head>
	<meta charset="UTF-8">
    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=2.0 minimum-scale=0.5, user-scalable=no" />
    <meta name="screen-orientation" content="portrait">
    <meta name="x5-orientation" content="portrait">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
	<title>跑步</title>

    <link rel="stylesheet" href="/static/css/weui.min.css">
{#    <link rel="stylesheet" href="/static/css/jquery-weui-1.20.css">#}
	<link rel="stylesheet" href="/static/css/material.min.css">

	<link rel="stylesheet" href="/static/css/jquery-weui.min.css">
	<link rel="stylesheet" href="/static/css/share.css" />
    <link rel="stylesheet" href="/static/css/goal.css" />
	<link rel="stylesheet" href="/static/css/running_1.css" />
    <link rel="stylesheet" href="/static/css/public.css">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_591099_seftw34bkl04quxr.css" />


    <style>
        /*  去除广告  */
        #_embed_v3_dc {
            display: none;
        }
        iframe {
            display: none;
        }
        /*  */
        .weui-photo-browser-modal{
            z-index: 10;
        }
        p{
            margin: 0;
            padding: 0;
        }
        .mdl-card{
            min-height: 0;
            max-height: 300px;
            height: 190px;
        }

        .header-mask{
            height: 90px;
            position: absolute;
            bottom: 0;
            width: 100%;
            bottom: 0;
            {#background-color: rgba(0,0,0,1);#}
            background:linear-gradient(rgba(0,0,0,0),rgba(0,0,0,1));
        }

        .after-finish ,.after-stop ,.today,.firstDay{
            color: #000000;
        }
        #upload-popup__distance-panel{
            border-bottom:0.5px solid   #ededed;
            margin:0 10%;
        }
        #upload-popup__distance-text{
            max-width: 60px;
        }
        #upload-image-panel{
            margin-top: 20px;
            border: none;
        }
        #reading-confirm-btn{
            background-color: #ffffff;
            color:rgba(31,162,255,1) ;
            border-top: 1px solid rgba(31,162,255,1);
        }

        .icon-icontjzp{
            font-size: 70px;
            color: #999999;
        }

        .mdl-textfield{
            padding: 0;
        }
        #avoid-btn{
            margin-bottom: 10px;
            display: block;
            overflow: hidden;
            width: 25%;
            border: 1px solid #FFAB18;
            height: 32px;
            line-height: 30px;
        }
        .header_date-text{
            margin-bottom:0;
        }
        .box_content{
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            margin: auto;
            right: 0;
        }

        .box_left{
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            margin: auto;

        }
        .icon-icontjzp{
            line-height:120px;
        }
        .news-item__content{
            margin-left: 46px;
            margin-top: 10px;
            margin-bottom: 10px;
            max-height: 100px;
            height: 100px;
            overflow: hidden;

        }
        .news-item__content .weui-flex__item{
            position: relative;
            max-height: 100px;
            height: 100px;
            overflow: hidden;
            max-width: 31%;
            margin-left: 1%;
        }
        .news-item__content-img{
            max-width:100%;
            {#max-height:95%;#}
            width: 100%;
            opacity: 0;
        }

        .challenger_deposit{
            font-family:"Microsoft YaHei";
            background-color: white;
            width: 15px;
            text-align: center;
            color: black;
            border: 1px solid rgba(0,0,0,0.4);
            display: inline-block;
            font-size: 19px;
            position: relative;
            overflow: hidden;

        }

        .challenger_deposit_{
            font-family:"Microsoft YaHei";
            width: 15px;
            text-align: center;
            color: white;
            display: inline-block;
            font-size: 16px;
            position: relative;
            overflow: hidden;
        }
        .challenger_deposit__{
            position: absolute;
            color: white;
            width: 15px;
            {#font-weight:bold;#}
            left: 0;
            right: 0;
            bottom: 0;
            top: 0;
            line-height: 23px;
            height: 25px;
            font-size: 8px;
            {#display: none;#}
        }
        .mask_on{
            position: fixed;
            z-index: 1000;
            top: 0;
            right: 0;
            left: 0;
            bottom: 0;
            background: rgba(0,0,0,.6);
        }
        .qqGroupCode_box,.activityDescription_box,.detailed_box_text{
            position: fixed;
            z-index: 5000;
            width: 80%;
            max-width: 300px;
            top: 50%;
            left: 50%;
            -webkit-transform: translate(-50%,-50%);
            transform: translate(-50%,-50%);
            background-color: #fff;
            text-align: left;
            overflow: hidden;
            padding: 25px;
            font-size: 10px;
            border-radius: 10px;
            color:rgba(0,0,0,0.5)
        }


        #upload-image-panel img{
            border-radius: 0;
        }
        #upload-panel{
            height: auto!important;
        }

        .weui-btn::after{
            border: none;
        }
        .header_avatar-text{
            margin-bottom: 5px;
            font-size: 14px;
        }

        #date-panel {
            padding: 0px 5px 10px 5px;
        }
        #date-panel:after{
            border: none;
        }


        .header_date{
            margin-bottom: 0;
        }
        .header_date.active>span  {
            border-bottom: 2px solid  #1fa2ff;
        }
        .icon-weixiaozhuanhuan-{
            opacity: 0;
            color: #1fa2ff;
            display: block;
            line-height: 10px;
            font-size: 24px;
        }
        .header_date.active>i  {
            opacity: 0;
        }
        .header_date.active{
            color: #000000;
            {#background: #1fa2ff;#}
            background: inherit;

        }
        /*  完成 */
        .after-finish  >i{
            opacity: 1;
        }
        /*  没有完成 */
        .after-stop >i{
            opacity: 0;
        }
        .notouch >i{
            opacity: 0;
        }
        .header_date::after{
            width:0;
            height: 0;
        }

        .coloum-space{
            margin-top: 5px;
            margin-bottom: 5px;
        }
        .mask_on{
            position: fixed;
            z-index: 1000;
            top: 0;
            right: 0;
            left: 0;
            bottom: 0;
            background: rgba(0,0,0,.6);
        }

        .mask_on_1{
            position: fixed;
            z-index: 99999;
            top: 0;
            right: 0;
            left: 0;
            bottom: 0;
            background: rgba(0,0,0,.1);
        }
        .mask_on__1{
            position: fixed;
            z-index: 9990;
            top: 0;
            right: 0;
            left: 0;
            bottom: 0;
            background: rgba(0,0,0,.0);
        }
        .weui-popup__container.weui-popup__container--visible{
            display: block !important;
        }

        #upload-popup .two{
            background: rgba(250,255,250,1);
            backface-visibility: hidden;
            margin: auto;
            top: 0;
            bottom:20%;
            left: 0;
            right: 0;
            width: 80%;
            height:initial;
            {#z-index: 9999!important;#}
            overflow: hidden;
            border-radius: 15px;
            opacity: 0;
            display: none;
        }

        #upload-popup .one{
            backface-visibility: hidden;
            {#z-index: 107;#}
        }
        #upload-popup .weui-popup__overlay{
            background-color: rgba(0,0,0,.0);
            {#z-index:9;#}
        }

        #upload-popup .container{
            position: relative;
            transition:0.5s;
            transform-style: preserve-3d;
            height: inherit;
            z-index: 10;
            background-color: rgba(0,0,0,.0);
        }
        .mask_on__container{
            position: fixed;
            z-index: 4;
            top: 0;
            right: 0;
            left: 0;
            bottom: 0;
            background: rgba(0,0,0,.6);
            display: none;
        }

    </style>
    <style>
        .reply_data{
            margin-top: 10px;
        }
         /*
        点赞，举报，回复
         */
        .button_sty{
            margin-left: 0px;
            min-width: 50px;
            max-width: 120px;
            padding: 1px 0px;
            height: 22px;
            line-height: 18px;
            color: rgba(31,162,255,1);
            /*
            border: 1px #1fa2ff solid;
            */
            border: none;
        }

        .button_sty_yes{
            margin-left:0px;
            min-width: 50px;
            max-width: 120px;
            padding: 1px 0px;
            height: 22px;
            line-height: 18px;
            color: rgba(182, 193, 200,1);
            border: none;
        }
        .button_sty_yes > span{
            color: rgba(182, 193, 200,1);
        }

        .icon-dianzan{
            font-size: 14px;
        }

        .modalTextarea_box{
            width: 96%;
            height: 150px;
            font-size: 17px;
            border: 1px #f6f1f1 solid;
            padding: 2%;
        }

        .modalTextarea{
            {#border: #e7e7e7 solid 1px;#}
            height: 150px;
            font-size: 17px;
            border: none;
            text-indent: 2em;
            width: 100%;
            {#border-top: 1px #f6f1f1 solid;#}
            {#border-bottom: 1px #f6f1f1 solid;;#}
        }

        .day-index .right{
            display: none;
        }
        .day-index .left{
            display: none;
        }

        #upload-panel .runing_bg{
            background: url(/static/images/running/runing_bg.png) no-repeat;
            background-size: 100% 100%;
        }

        #upload-panel .panel__split{
            background-color:white;
        }

    </style>

</head>

<body ontouchstart>
	<div class="image-header mdl-card mdl-shadow--2dp">
		<div class="header-mask"></div>
		<div class="header-desc mdl-card__supporting-text">
			<!--跑步页首-->
			<div class="row-center between">
                <div class="coloum-space" style="width: 30%">
                    <div class="header_avatar-text">
                        {{ app.active_participants }}人参与
                    </div>
                    <div class="header__avatars">
                        {% for person in persons %}
                            <img class="img-circle" src="{{ person.headimgurl }}">
                        {% endfor %}
{#                        <img class="img-circle" src="/static/fake/running_1.jpg">#}
{#                        <img class="img-circle" src="/static/fake/running_2.jpg">#}
{#                        <img class="img-circle" src="/static/fake/running_3.jpg">#}
{#                        <img class="img-circle" src="/static/fake/running_4.jpg">#}
{#                        <img class="img-circle" src="/static/fake/running_5.jpg">#}

				    </div>
                </div>
				<div class="coloum-space" style="position: absolute;left: 50%;transform: translate(-50%,0%);">
                    <div class="header_avatar-text center">总系数</div>
					<div class="header__text">
                        <span style="color: #1fa2ff; font-weight: 500;">{{ app.coefficient }}</span>
                    </div>
				</div>
				<div class="coloum-space">
                    <div class="header_avatar-text center">奖金池</div>
                    <div class="header__text">
                        <span style="color: #ff931f; font-weight: 500;" id="app_bonus_all">{{ app.bonus_all|floatformat:"0" }}</span>
                        <span>元</span>
                    </div>
				</div>
			</div>
		</div>

        <div style="position: absolute;right: 20px;color: white;top:10px;font-size: 16px;height: 20px;line-height: 20px;display: none">

            <div class="challenger_deposit_" style="width: auto;">
                <span class="" style="width: 60px">擂主押金</span>
            </div>
            <div class="challenger_deposit">
                <span class="challenger_deposit_0" style="">1</span>
                <span class="challenger_deposit__">一</span>
            </div>
            <div class="challenger_deposit">
                <span class="challenger_deposit_1" style="">1</span>
                <span class="challenger_deposit__">一</span>
            </div>
            <div class="challenger_deposit">
                <span class="challenger_deposit_2" style="">1</span>
                <span class="challenger_deposit__">一</span>
            </div>
            <div class="challenger_deposit">
                <span  class="challenger_deposit_3"  style="">1</span>
                <span class="challenger_deposit__">一</span>
            </div>
            <div class="challenger_deposit">
                <span class="challenger_deposit_4" style="">1</span>
                <span class="challenger_deposit__">一</span>
            </div>
            <div class="challenger_deposit">
                <span class="challenger_deposit_5" style="">1</span>
                <span class="challenger_deposit__">一</span>
            </div>
            <div class="challenger_deposit">
                <span class="challenger_deposit_6" style="">1</span>
                <span class="challenger_deposit__">一</span>
            </div>

        </div>

        <div id="qqGroupCode" style="position: absolute;right:20px;top: 20px;width: 30px;">
           <img src="/static/images/user/share@2x.png" style="width: 100%;">
        </div>


        <div id="activityDescription_but" style="position: absolute;right:20px;top: 55px;width: 30px;">
            <img src="/static/images/user/doubt@2x.png" style="width: 100%;">
        </div>

        <div style="position: absolute;left:23px;bottom: 75px;color: white">
            {% if goal.goal_type == 0 %}自由模式{% else %}日常模式{% endif %}
        </div>

	</div>


	<div class="block-panel" id="profit-panel" style="padding: 5px 5px 0px 5px;">
		<div class="row-center">
			<div class="coloum-space" id="detailed_box_text_but">
				<div class="header_avatar-text goal-header-block">我的押金</div>
				<div class="header__text">
					<span id="guaranty_down_payment" style="color: #565c66; font-weight: 600;"></span>
				</div>
			</div>
			<div class="coloum-space">
				<div class="header_avatar-text" style="color: #B6C1C8; font-size: 0.8rem;">我的系数</div>
				<div class="header__text">
                    <span class="goal_guaranty" style="color: #565c66;font-weight: 600;position: relative;">
                        <span id="guaranty_new_coeff">{{ default|default:'0' }}</span>
                        <span style="color: #eca285;font-size: 0.6rem;position: absolute;right:-40px;padding: 0 5px;top: 2px;">{{ extra_coeff|default:'' }}</span>
                    </span>

{#					<span style="color: #565c66;  font-weight: 600;" id="guaranty_new_coeff">#}
{#                        {{ goal.coefficient }}#}
{#                    </span>#}
				</div>
			</div>
			<div class="coloum-space">
				<div class="header_avatar-text" style="color: #B6C1C8; font-size: 0.8rem;">累计收益</div>
				<div class="header__text">
					<span style="color: #565c66;  font-weight: 600;">{{ goal.bonus }}</span>
                    <div style="display: inline-block;margin-left: 5px">
                        <p id="invite_num_plus_1" class="invite_num_plus" style="font-size: 0.4rem;color: #eca285;line-height: 0.4rem;text-align: center;"></p>
                        <p id="invite_num_plus_1_1"  class="invite_num_plus" style="font-size: 0.4rem;color: #eca285;line-height: 0.4rem;text-align: center;margin-top: 2px;"></p>
                        <p id="invite_num_plus_2"  class="" style="font-size: 0.4rem;color: #B6C1C8;line-height: 0.4rem;display: none"></p>
                    </div>
				</div>
			</div>
		</div>
	</div>
	<div class="block-panel" id="date-panel" style="margin-bottom: 0;padding-bottom: 0;">
		<div class="row-center  row-center_1">

            <div class="coloum-space">
                <div class="header_date-text">一</div>
            </div>
            <div class="coloum-space">
                <div class="header_date-text">二</div>
            </div>
            <div class="coloum-space">
                <div class="header_date-text">三</div>
            </div>
            <div class="coloum-space">
                <div class="header_date-text">四</div>
            </div>
            <div class="coloum-space">
                <div class="header_date-text">五</div>
            </div>
            <div class="coloum-space">
                <div class="header_date-text">六</div>
            </div>
            <div class="coloum-space">
                <div class="header_date-text">日</div>
            </div>
        </div>

        <div class="swiper-container_1">
            <div class="swiper-wrapper">
                {% for day in datesinform %}
                    <div class="swiper-slide">
                        <div class="row-center" >
                            {% for dates in day %}
                            <div class="coloum-space">
                                <div num ="{{ dates.dayindex }}" class="header_date
                               {% if  dates.is_day_now|yesno:"1,0" == "1" %}
                               active today
                                    {% if dates.isnosignin|yesno:"1,0" == "1" or dates.isfinish|yesno:"1,0" == "1" %}
                                    after-finish
                                    {% else %}
                                    {% endif %}

                               {% else %}
                                   {% if dates.dayindex == "-1" %}
                                   notouch
                                   {% elif dates.dayindex == 1 %}
                                   firstDay
                                        {% if first_day_record == 1 %}
                                            after-finish
                                        {% else %}
                                        {% endif %}
                                   {% elif dates.isnosignin|yesno:"1,0" == "1" or dates.isfinish|yesno:"1,0" == "1" %}
                                        after-finish
                                   {% else %}
                                        after-stop
                                   {% endif %}
                               {% endif %} ">

                                    {% if dates.date == "0" %}

                                    {% else %}
                                        <span style="padding-bottom:5px;">{{ dates.date }}</span>
                                    {% endif %}


                                <i class="iconfont icon-weixiaozhuanhuan-" style=""></i>

                                </div>
                            </div>
                           {% endfor %}

                        </div>
                    </div>
                {% endfor %}

            </div>
        </div>

	</div>
{#    <div>#}
{#        {{ datesinform }}#}
{#    </div>#}



    <div id="upload-panel">
    {% for day in datesinform %}
        {% for dates in day %}
            {% if dates.dayindex > 0 %}

                <div class="day-index dayindex_{{ dates.dayindex }}" {% if dates.date == "0" %}style="display: none;" {% else %} {% if dates.is_day_now|yesno:"1,0" == "1" %}{% else %}style="display: none;"{% endif %}{% endif %} >

                    {% if first_day_record == 1 %}
                        第{{ dates.dayindex }}天
{#                    {% elif dates.dayindex == 1 and not dates.isfinish %}#}
{#                        第{{ dates.dayindex|add:-1 }}天#}
                    {% else %}
                        第{{ dates.dayindex|add:-1 }}天
                    {% endif %}

                    <div class="panel__body">
                        <div class="upload-sidebar left"></div>

                            {% if dates.isfinish %}
                                <!--  完成任务-->
                                <div class="upload-card row-center center nopadding runing_bg">
                                    <div class="weui-flex" style="height: 100%;width: 100%;padding: 5px">
                                        <div class="weui-flex__item" style="position:relative;overflow:hidden;margin: 30px 10px 15px;">
                                            <div>
                                                 <p class="font_white" style="margin-bottom: 1px;padding: 5px;font-size: 14px;">今日完成 <br><span class="font_orange_2" style="font-weight: 500;font-size: 20px">{{ dates.punch.distance }}</span>&nbsp;km</p>
                                            </div>
                                        </div>

                                        <div class="weui-flex__item" style="position:relative;overflow:hidden;margin: 30px 10px 15px;">
                                            <div>
                                                {% if goal.goal_type == 0 %}
                                                    <!-- 自由 -->
                                                    <p class="font_white" style="font-size: 12px">累计距离<br><span class="font_orange_2" style="font-weight: 500;font-size: 20px">{{ dates.add_distance }}</span>&nbsp;km</p>

                                                {% elif goal.goal_type == 1 %}

                                                    <!-- 日常 -->
                                                    <p class="panel__title font_white">剩余天数<br><span class="font_orange_2" style="font-weight: 500;font-size: 20px">
                                                        {% if goal.left_day >= 0 %}
                                                            {{ goal.left_day }}
                                                        {% else %}
                                                            0
                                                        {% endif %}
                                                        &nbsp;</span>天
                                                    </p>
                                                {% endif %}
                                            </div>
                                        </div>

                                        <!-- 当天 -->
                                        {% if goal.goal_type == 0 %}
                                            <!-- 自由 -->
                                            <div class="running__upload-notice small-font font_white">
                                                {% if goal.goal_day == 9999 %}
                                                     目标：在每7天跑步累计<span class="font_orange_2" style="">&nbsp;{{ goal.goal_distance }}&nbsp;</span>km &nbsp;
                                                {% else %}
                                                     目标：在<span class="font_orange_2" style="">&nbsp;{{ goal.goal_day }}&nbsp;</span>天内每7天跑步累计<span class="font_orange_2" style="">&nbsp;{{ goal.goal_distance }}&nbsp;</span>km &nbsp;
                                                {% endif %}
                                            </div>
                                        {% else %}
                                            <!-- 日常 -->

                                            <div class="running__upload-notice small-font font_white">
                                            {% if goal.goal_day == 9999 %}
                                                 目标：每日跑步<span class="font_orange_2" >&nbsp;{{ goal.kilos_day }}&nbsp;</span>km
                                            {% else %}
                                                 目标：在<span class="font_orange_2">&nbsp;{{ goal.goal_day }}&nbsp;</span>天内每日跑步<span class="font_orange_2" >&nbsp;{{ goal.kilos_day }}&nbsp;</span>km
                                            {% endif %}
                                            </div>
                                        {% endif %}
                                    </div>
                                </div>
                            {% elif not dates.isfinish and dates.isnosignin %}
                                <div class="upload-card row-center center nopadding runing_bg">
                                    <div class="coloum-space center">
                                        <span class="font_white" style="">已使用免签券抵消</span>
                                    </div>
                                </div>
                            {% elif not dates.isfinish %}

                                {% if dates.dayindex == 1 %}
                                    <!-- 第一天准备中 -->

                                        {% if goal.goal_type == 0 and dates.is_day_now|yesno:"1,0" == "1" %}
                                            <!-- 自由 -->
                                            <div class="upload-card row-center center runing_bg" >
                                                <div class="coloum-space center font_white">

                                                    <p style="font-size: 16px">首日准备中，次日开始</p>
                                                    <p>（小贴士：首日打卡可直接开始）</p>

                                                </div>
                                                <div class="running__upload-notice small-font font_white">
                                                    {% if goal.goal_day == 9999 %}
                                                         目标：在每7天跑步累计<span class="font_orange_2" style="">&nbsp;{{ goal.goal_distance }}&nbsp;</span>km &nbsp;
                                                    {% else %}
                                                         目标：在<span class="font_orange_2" style="">&nbsp;{{ goal.goal_day }}&nbsp;</span>天内每7天跑步累计<span  class="font_orange_2"  style="">&nbsp;{{ goal.goal_distance }}&nbsp;</span>km
                                                    {% endif %}
                                                </div>
                                            </div>

                                        {% elif goal.goal_type == 1 and dates.is_day_now|yesno:"1,0" == "1" %}

                                            <!-- 日常 -->
                                            <div class="upload-card row-center center nopadding runing_bg">
                                                <div class="coloum-space center font_white">

                                                    <p style="font-size: 16px">首日准备中，次日开始</p>
                                                    <p>（小贴士：首日打卡可直接开始）</p>


                                                    <!---
                                                    <p class="panel__title">剩余天数</p>
                                                    <div class="row-center center">
                                                        <div>
                                                            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
                                                                 width="28px" height="28px" viewBox="0 0 36 36" enable-background="new 0 0 36 36" xml:space="preserve">
                                                            <path fill="#bc6eff" d="M27.692,5H25V4.494c0-0.552-0.447-1-1-1s-1,0.448-1,1V5H13V4.494c0-0.552-0.447-1-1-1s-1,0.448-1,1V5H8.308
                                                                C5.381,5,3,7.9,3,10.857V26.13C3,29.087,5.381,31,8.308,31h19.385C30.619,31,33,29.087,33,26.13V10.857C33,7.9,30.619,5,27.692,5z
                                                                 M8.308,7H11v1.494c0,0.552,0.447,1,1,1s1-0.448,1-1V7h10v1.494c0,0.552,0.447,1,1,1s1-0.448,1-1V7h2.692
                                                                C29.517,7,31,9.002,31,10.857v0.789C30.851,11.558,30.686,11,30.5,11h-25c-0.186,0-0.351,0.558-0.5,0.647v-0.789
                                                                C5,9.002,6.483,7,8.308,7z M27.692,29H8.308C6.483,29,5,27.985,5,26.13V13.34C5.149,13.429,5.314,13,5.5,13h25
                                                                c0.186,0,0.351,0.429,0.5,0.34v12.79C31,27.985,29.517,29,27.692,29z"/>
                                                            </svg>
                                                        </div>
                                                        <span class="panel__target-text" style="margin-left: 20px;margin-right: 20px;font-weight: 600;">{{ goal.left_day }}</span>
                                                        <span style="color: #B6C1C8;">天</span>
                                                    </div>

                                                    -->

                                                </div>
                                                <div class="running__upload-notice small-font font_white">
                                                    {% if goal.goal_day == 9999 %}
                                                         目标：每日跑步<span class="font_orange_2" style="">&nbsp;{{ goal.kilos_day }}&nbsp;</span>km
                                                    {% else %}
                                                         目标：在<span class="font_orange_2" style="">&nbsp;{{ goal.goal_day }}&nbsp;</span>天内每日跑步<span class="font_orange_2" style="">&nbsp;{{ goal.kilos_day }}&nbsp;</span>km
                                                    {% endif %}
                                                </div>
                                            </div>

                                        {% else %}
                                            <div class="upload-card row-center center nopadding runing_bg">
                                                <div class="coloum-space center font_white">
                                                    <span class="font_white" style="" id="unfinishedTask_1"></span>
                                                    <p style="font-size: 16px">首日准备中，次日开始</p>
                                                    <p>（小贴士：首日打卡可直接开始）</p>
                                                </div>
                                            </div>
                                        {% endif %}

                                {% else %}
                                    <!-- 未完成任务  -->
                                    {% if goal.goal_type == 0 and dates.is_day_now|yesno:"1,0" == "1" %}
                                        <!-- 自由 -->
                                        <div class="upload-card row-center center nopadding runing_bg">

                                            <div class="coloum-space center font_white" style="">
                                                    未打卡
                                                <p style="margin: 10px;display: none">
                                                    <span class="font_white" style="">剩余距离</span>
                                                    <span class="panel__target-text font_orange_2" style="margin-left: 5px;margin-right:5px;font-weight: 600;">
                                                        {% if goal.left_distance >= 0 %}
                                                            {{ goal.left_distance }}
                                                        {% else %}
                                                            0
                                                        {% endif %}
                                                    </span>
                                                    <span class="font_white" style="">km</span>
                                                </p>
                                            </div>

                                            <div class="panel__split"></div>
                                            <div class="coloum-space center">
                                                {% if goal.left_distance <= 0 %}
                                                    <span class="font_white" style="">已经完成</span>
                                                {% else %}
                                                    <p class="panel__title font_white">剩余距离</p>
                                                        <div class="row-center center">
                                                            <div>
                                                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                                                                     width="28px" height="28px" viewBox="0 0 36 36" enable-background="new 0 0 36 36" xml:space="preserve">
                                                                    <g>
                                                                        <path fill="#ff9947" d="M25.723,14c0-3.86-3.141-7-7-7s-7,3.14-7,7s3.141,7,7,7S25.723,17.86,25.723,14z M13.723,14c0-2.757,2.243-5,5-5
                                                                            s5,2.243,5,5s-2.243,5-5,5S13.723,16.757,13.723,14z"/>
                                                                        <path fill="#ff9947" d="M29,32h-9l8.818-10.02c1.876-2.307,2.907-5.213,2.904-8.183c0-5.755-3.698-10.751-9.202-12.433
                                                                            c-1.234-0.376-2.512-0.568-3.797-0.568c-4.331,0-8.361,2.145-10.782,5.737c-3.216,4.773-2.94,10.983,0.712,15.484L17.445,32H9v-2H7
                                                                            v4h24v-4h-2V32z M9.6,7.652c2.049-3.04,5.459-4.855,9.124-4.855c1.087,0,2.168,0.162,3.213,0.481
                                                                            c4.657,1.422,7.786,5.65,7.786,10.521c0.003,2.512-0.869,4.97-2.431,6.89l-8.569,9.736l-8.543-9.697
                                                                            C7.112,16.945,6.879,11.691,9.6,7.652z"/>
                                                                    </g>
                                                                </svg>
                                                            </div>
                                                            <span class="panel__target-text" style="color: #ff931f;">{{ goal.left_distance }}</span>
                                                            <span class="panel__target-text__side font_white">km</span>
                                                        </div>

                                                {% endif %}
                                            </div>
                                            <div class="running__upload-notice small-font font_white">
                                                {% if goal.goal_day == 9999 %}
                                                    目标：在每7天跑步累计<span class="font_orange_2" style="">&nbsp;{{ goal.goal_distance }}&nbsp;</span>km
                                                {% else %}
                                                    目标：在<span class="font_orange_2" style="">&nbsp;{{ goal.goal_day }}&nbsp;</span>天内每7天跑步累计<span class="font_orange_2" style="">&nbsp;{{ goal.goal_distance }}&nbsp;</span>km
                                                {% endif %}
                                            </div>
                                        </div>
                                        {% elif goal.goal_type == 1 and dates.is_day_now|yesno:"1,0" == "1" %}
                                        <!-- 日常 -->
                                        <div class="upload-card row-center center nopadding runing_bg">

                                            <div class="coloum-space center">
                                                <p class="panel__title font_white" style="margin-top: 20px">剩余天数</p>
                                                <div class="row-center center">
                                                    <div>
                                                        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
                                                             width="28px" height="28px" viewBox="0 0 36 36" enable-background="new 0 0 36 36" xml:space="preserve">
                                                        <path fill="#bc6eff" d="M27.692,5H25V4.494c0-0.552-0.447-1-1-1s-1,0.448-1,1V5H13V4.494c0-0.552-0.447-1-1-1s-1,0.448-1,1V5H8.308
                                                            C5.381,5,3,7.9,3,10.857V26.13C3,29.087,5.381,31,8.308,31h19.385C30.619,31,33,29.087,33,26.13V10.857C33,7.9,30.619,5,27.692,5z
                                                             M8.308,7H11v1.494c0,0.552,0.447,1,1,1s1-0.448,1-1V7h10v1.494c0,0.552,0.447,1,1,1s1-0.448,1-1V7h2.692
                                                            C29.517,7,31,9.002,31,10.857v0.789C30.851,11.558,30.686,11,30.5,11h-25c-0.186,0-0.351,0.558-0.5,0.647v-0.789
                                                            C5,9.002,6.483,7,8.308,7z M27.692,29H8.308C6.483,29,5,27.985,5,26.13V13.34C5.149,13.429,5.314,13,5.5,13h25
                                                            c0.186,0,0.351,0.429,0.5,0.34v12.79C31,27.985,29.517,29,27.692,29z"/>
                                                        </svg>
                                                    </div>
                                                    <span class="panel__target-text font_orange_2" style="margin-left: 20px;margin-right: 20px;font-weight: 600;">
                                                        {% if goal.left_day >= 0 %}
                                                            {{ goal.left_day }}
                                                        {% else %}
                                                            0
                                                        {% endif %}

                                                    </span>
                                                    <span class="font_white" style="">天</span>
                                                </div>
                                            </div>
                                            <div class="running__upload-notice small-font font_white">
                                                {% if goal.goal_day == 9999 %}
                                                     目标：每日跑步<span class="font_orange_2" >&nbsp;{{ goal.kilos_day }}&nbsp;</span>km
                                                {% else %}
                                                     目标：在<span class="font_orange_2">&nbsp;{{ goal.goal_day }}&nbsp;</span>天内每日跑步<span class="font_orange_2" >&nbsp;{{ goal.kilos_day }}&nbsp;</span>km
                                                {% endif %}
                                            </div>
                                        </div>
                                    {% else %}
                                        <div class="upload-card row-center center nopadding runing_bg">
                                            <div class="coloum-space center">
                                                <span class="font_white" style="" id="unfinishedTask_{{ dates.dayindex }}">未完成任务</span>
                                            </div>
                                        </div>
                                    {% endif %}
                                {% endif %}

                            {% else %}
                                <div class="upload-card row-center center nopadding">
                                    <div class="coloum-space center">
                                        <span class="font_white" style="">别着急，任务还没开始呢！</span>
                                    </div>
                                </div>
                            {% endif %}
                            <div class="upload-sidebar right"></div>
                    </div>


                    {% if dates.is_day_now|yesno:"1,0" == "1" and not dates.isfinish %}
                        <input id="datesdayindex" type="hidden" value="{{ dates.dayindex }}">
                        {% if dates.isnosignin %}
                            <button class="weui-btn weui-btn_primary upload-btn__style" style="background: #BDBDBD;" disabled>
                                已免签
                            </button>
                        {% else %}
                            <button class="bg_color_1_ weui-btn weui-btn_primary upload-btn__style" id="upload-btn"  reload="{{ dates.punch.reload }}" Num="1">
                                上传任务
                            </button>
                            {% if goal.goal_type == 0 %}

                            {% else %}
                                {% if dates.dayindex == 1 %}

                                {% else %}
                                    <button class="weui-btn weui-btn_primary" id="avoid-btn">
                                        <span>免签</span>x<span id="avoid-count">{{ nosign }}</span>
                                    </button>
                                {% endif %}

                            {% endif %}

                        {% endif %}
                    {% elif dates.is_day_now|yesno:"1,0" == "1" and dates.isfinish %}
                        <button class="bg_color_1_ weui-btn weui-btn_primary upload-btn__style hide"  reload="{{ dates.punch.reload }}"  punch_id ='{{ dates.punch.punch_id }}'  id="upload-btn"  Num="2" >
                            重新上传
                        </button>
{#                        {% if dates.punch.reload > 3 %} disabled {% else %} {% endif %}#}

                    {% elif dates.is_day_now|yesno:"1,0" == "0" and not dates.isfinish %}
                        {% if dates.dayindex == 1 %}

                        {% else %}
                            <button class="weui-btn weui-btn_primary upload-btn__style" style="background: #BDBDBD;" disabled>
                                未打卡
                            </button>
                        {% endif %}
                    {% elif dates.is_day_now|yesno:"1,0" == "0" and dates.isfinish %}
                        <button class="weui-btn weui-btn_primary upload-btn__style" style="background: #BDBDBD;" disabled>
                            已成功打卡
                        </button>
                    {% elif dates.is_day_now|yesno:"1,0" == "0" and dates.isnosignin %}
                        <button class="weui-btn weui-btn_primary upload-btn__style" style="background: #BDBDBD;" disabled>
                            已免签
                        </button>
                    {% else %}
                         <button class="weui-btn weui-btn_primary upload-btn__style" style="background: #BDBDBD;" disabled>
                            尚未开始
                        </button>

                    {% endif %}

                </div>

            {% endif %}
        {% endfor %}
    {% endfor %}
    </div>

<!---------------动态----------------------------------------------->
        <!-- 动态 样式 -->
    <style>
        .news-list {
            border-top: 1px solid #e5e5e5;
            margin-bottom: 0;
        }
        .news-list {
            list-style: none;
            background: #F5F5F5;
        }
        .news-list .news-item:last-child {
            margin-bottom: 0px;
        }
        .news-item:nth-child(1) {
            border-top: none;
            background-color: white;
        }
        .new-item__content {
            padding-top: 20px;
            padding-left: 10px;
            padding-right: 10px;
        }
        .news-item__header-img {
            width: 32px;
            height: 32px;
            box-sizing: border-box;
            border-radius: 50%;
            background-color: white;
        }
        .news-item__header-text {
            margin-left: 10px;
            font-size: 0.7rem;
        }
        .news-item__content {
            position: relative;
            max-height: 100px;
            height: auto;
            overflow: hidden;
        }

        .reply_data {
            margin-top: 10px;
        }
        .news-item__horzon {
            width: 100%;
            margin-top: 10px;
            margin-bottom: 10px;
            background: #B6C1C8;
        }
        .news-item__bottom {
            margin-bottom: 10px;
        }
         /*
        点赞，举报，回复
         */
        .button_sty{
            margin-left: 5px;
            min-width: 50px;
            max-width: 120px;
            padding: 1px 5px;
            height: 22px;
            line-height: 18px;
            color: rgba(31,162,255,1);
            background-color: rgba(0,0,0,0);
            /*
            border: 1px #1fa2ff solid;
            */
            border: none;
        }

        .button_sty_yes{
            margin-left: 5px;
            min-width: 50px;
            max-width: 120px;
            padding: 1px 5px;
            height: 22px;
            line-height: 18px;
            color: rgba(182, 193, 200,1);
            background-color: rgba(0,0,0,0);
            border: none;
        }
        .button_sty_yes > span{
            color: rgba(182, 193, 200,1);
        }

        .icon-dianzan{
            font-size: 14px;
        }
        .modalTextarea_box {
            width: 96%;
            height: 150px;
            font-size: 17px;
            border: 1px #f6f1f1 solid;
            padding: 2%;
        }
        .modalTextarea{
            {#border: #e7e7e7 solid 1px;#}
            height: 150px;
            font-size: 17px;
            border: none;
            text-indent: 2em;
            width: 100%;
            {#border-top: 1px #f6f1f1 solid;#}
            {#border-bottom: 1px #f6f1f1 solid;;#}
        }
        input,button,select,textarea{outline:none}
        textarea{resize:none}


        .rank_change_active,.load_comments_active{
            border-bottom: 2px solid  rgba(255,171,24,1);
        }
        .rank_box{
            display: none;
        }

        .rank_1{
            display: block;
        }

        .height_22{
            line-height: 2.2rem;
            height: 2.2rem;
        }
        .rank_border_bottom {
            border-bottom: 1px solid rgba(204,204,204,0.5);
        }
        .rank_border_bottom .rank_img{
            border-radius:5px;
            float: left;
            width: 1.4rem;
            height: 1.4rem;
            display:block;
            overflow:hidden;
            background: url('/static/avatar/100445.jpg') no-repeat;
            background-size: cover;
            margin-top: 0.4rem;
        }
        .rank_border_bottom .rank_name{
            display:block;float: left;border-radius: 5px;margin: 0 10px
        }
        .rank_ranking img{
            width: 1.2rem;height: 1.2rem;
        }

        .uploaderInput_box_{
            width: 28%;
            margin-left: 2%;
            height: 100px;
        }
        .news-item__content-img {
            width: 32%;
        }
        #tab2 .news-item__header-text{
            color: #5b6a92;
        }
    </style>
        <!-- 动态 -->
    <div class="bg_white" style="">
        <div class="weui-tab" style="z-index: 3;width: 100%">
            <div class="weui-navbar bg_white" id="fixed_TOP">
                <a class="weui-navbar__item" href="#tab1">
                    排行榜
                </a>

                <a class="weui-navbar__item weui-bar__item--on" href="#tab2">
                    动态
                </a>

            </div>

            <div class="weui-tab__bd">
                <div id="tab1" class="weui-tab__bd-item">

                    <div class="weui-flex font_size_6" style="margin-top: 10px;height: 30px;line-height: 30px;margin-left:30px;margin-right: 30px">
                        <div class="weui-flex__item rank_change text_center rank_change_active" data-sta="1">
                            距离榜
                        </div>
                        <div class="weui-flex__item rank_change text_center hide" data-sta="2">
                            周距离榜
                        </div>
                        <div class="weui-flex__item rank_change text_center" data-sta="3">
                            坚持榜
                        </div>
                        <div class="weui-flex__item rank_change text_center" data-sta="4">
                            收益榜
                        </div>
                    </div>

                    <!--  距离榜 -->
                    <div class="rank_box fadeInLeft_1 rank_1" style="margin: 00px 20px;">
                        <!-- 前三排行-->
                        <div  class="weui-flex rank_border_bottom" style="margin-top: 30px;display: none">
                            <div class="weui-flex__item">
                                <div style="width: 100%;height: 100%;margin-top: 20px">
                                    <div style="position: relative">
                                        <img class="ranking_2_headimgurl" src="/static/avatar/100000.jpg" style="border-radius: 50%;width: 50%;display: block;margin: auto;border: 2px solid black;">
                                        <div style="position: absolute;top: -10px;width: 20%;right:55%;margin: auto;">
                                            <img src="/static/images/aprilFool/2@2x.png" style="width: 100%">
                                        </div>
                                        <div style="position: absolute;bottom: 10px;right:0;margin: auto;width: 40%; ">
                                            <img src="/static/images/aprilFool/2_1@2x.png" style="width: 65%;">
                                        </div>
                                    </div>
                                    <p class="ranking_2_nickname" style="text-align: center;">小明</p>
                                </div>
                            </div>
                            <div class="weui-flex__item">
                                <div style="width: 100%;height: 100%;">
                                    <div style="position: relative">
                                        <img class="ranking_1_headimgurl" src="/static/avatar/100000.jpg" style="border-radius: 50%;width: 70%;display: block;margin: auto;border: 2px solid black;">
                                        <div style="position: absolute;top: -15px;width: 25%;right:55%;margin: auto;">
                                            <img src="/static/images/aprilFool/1@2x.png" style="width: 100%">
                                        </div>
                                        <div style="position: absolute;bottom: 15px;right:-10px;margin: auto;width: 40%; ">
                                            <img src="/static/images/aprilFool/1_1@2x.png"  style="width: 65%;">
                                        </div>
                                    </div>
                                    <p class="ranking_1_nickname" style="text-align: center;">小王</p>
                                </div>
                            </div>
                            <div class="weui-flex__item">
                                <div style="width: 100%;height: 100%;margin-top: 20px">
                                    <div style="position: relative">
                                        <img class="ranking_3_headimgurl" src="/static/avatar/100259.jpg" style="border-radius: 50%;width: 50%;display: block;margin: auto;border: 2px solid black;">
                                        <div style="position: absolute;top: -10px;width: 20%;right:55%;margin: auto;">
                                            <img src="/static/images/aprilFool/3@2x.png" style="width: 100%">
                                        </div>
                                        <div style="position: absolute;bottom: 10px;right:0;margin: auto;width: 40%; ">
                                            <img src="/static/images/aprilFool/3_1@2x.png"  style="width: 65%;">
                                        </div>
                                    </div>
                                    <p class="ranking_3_nickname" style="text-align: center;">校长</p>
                                </div>
                            </div>
                        </div>
                        <!-- 前三排行 以外-->

                        <!-- 自己-->
                         <div class="weui-row weui-no-gutter rank_border_bottom height_22" style="margin-top: 0">
                             <div class="weui-col-15 text_center font_size_4" style="opacity: 0">
                                 我
                             </div>

                             <div class="weui-col-55 text_center">
                                 <div class="rank_img crruent_user_headimgurl" style="">
                                     <img class="" src="/static/avatar/100445.jpg" style="width: 100%;opacity: 0">
                                 </div>
                                 <div class="rank_name text_left">
                                     <p class="p_overflow font_size_5 crruent_user_name" style="line-height: 0.8rem;height: 0.8rem;margin-top: 0.4rem;">小娃娃</p>
                                     <p class="p_overflow font_size_5 crruent_user_rank" style="line-height: 0.8rem;height: 0.8rem;">第20+名</p>
                                 </div>
                             </div>

                             <div class="weui-col-30 text_center height_22 text_right">
                                 <p class="p_overflow height_22 crruent_user_rank_time padding_R_10">05:00:00</p>
                             </div>

                        </div>
                        <!-- 自己 end-->

                        <!-- 排行-->
                        <div class="rank_1_box">
                            <!-- 暂无人上榜 -->
                            <div class="weui-row weui-no-gutter rank_border_bottom height_22 nodata" style="display: none">
                                <div class="weui-col-20 text_center font_size_6 height_22 position_relative rank_ranking">

                                 </div>

                                <div class="weui-col-60 text_center">
                                    暂无人上榜
                                 </div>

                                <div class="weui-col-20 text_center height_22 text_right">

                                 </div>
                            </div>



                        </div>
                    </div>

                    <!-- 周距离榜 -->
                    <div class="rank_box fadeInLeft_1 rank_2 hide" style="margin: 00px 10px;">

                        <!-- 自己-->
                         <div class="weui-row weui-no-gutter rank_border_bottom height_22">
                             <div class="weui-col-15 text_center font_size_5" style="opacity: 0">
                                 我
                             </div>

                             <div class="weui-col-55 text_center">
                                 <div class="rank_img crruent_user_headimgurl" style="">
                                     <img class="" src="/static/avatar/100445.jpg" style="width: 100%;opacity: 0">
                                 </div>
                                 <div class="rank_name text_left">
                                     <p class="p_overflow font_size_5 crruent_user_name" style="line-height: 0.8rem;height: 0.8rem;margin-top: 0.4rem;">小娃娃</p>
                                     <p class="p_overflow font_size_5 crruent_user_rank" style="line-height: 0.8rem;height: 0.8rem;">第20+名</p>
                                 </div>
                             </div>

                             <div class="weui-col-30 text_center height_22 text_right">
                                 <p class="p_overflow height_22 crruent_user_rank_time padding_R_10"></p>
                             </div>

                        </div>

                        <!-- 排行-->
                        <div class="rank_2_box">
                            <!-- 暂无人上榜 -->
                            <div class="weui-row weui-no-gutter rank_border_bottom height_22 nodata" style="display: none">
                                <div class="weui-col-20 text_center font_size_6 height_22 position_relative rank_ranking">

                                 </div>

                                <div class="weui-col-60 text_center">
                                    暂无人上榜
                                 </div>

                                <div class="weui-col-20 text_center height_22 text_right">

                                 </div>
                            </div>

                        </div>
                    </div>

                    <!-- 坚持榜 -->
                    <div class="rank_box fadeInLeft_1 rank_3" style="margin: 00px 10px;">
                        <!-- 自己-->
                         <div class="weui-row weui-no-gutter rank_border_bottom height_22">
                             <div class="weui-col-15 text_center font_size_5"  style="opacity: 0">
                                 我
                             </div>

                             <div class="weui-col-55 text_center">
                                 <div class="rank_img crruent_user_headimgurl" style="">
                                     <img class="" src="/static/avatar/100445.jpg" style="width: 100%;opacity: 0">
                                 </div>
                                 <div class="rank_name text_left">
                                     <p class="p_overflow font_size_5 crruent_user_name" style="line-height: 0.8rem;height: 0.8rem;margin-top: 0.4rem;">小娃娃</p>
                                     <p class="p_overflow font_size_5 crruent_user_rank" style="line-height: 0.8rem;height: 0.8rem;">第10+名</p>
                                 </div>
                             </div>

                             <div class="weui-col-30 text_center height_22 text_right">
                                 <p class="p_overflow height_22 crruent_user_rank_time padding_R_10"></p>
                             </div>

                        </div>

                        <!-- 排行-->
                        <div class="rank_3_box">
                            <!-- 暂无人上榜 -->
                            <div class="weui-row weui-no-gutter rank_border_bottom height_22 nodata" style="display: none">
                                <div class="weui-col-20 text_center font_size_6 height_22 position_relative rank_ranking">

                                 </div>

                                <div class="weui-col-60 text_center">
                                    暂无人上榜
                                 </div>

                                <div class="weui-col-20 text_center height_22 text_right">

                                 </div>
                            </div>

                        </div>
                    </div>

                    <!-- 收益榜 -->
                    <div class="rank_box fadeInLeft_1 rank_4" style="margin: 00px 10px;">
                        <!-- 自己-->
                         <div class="weui-row weui-no-gutter rank_border_bottom height_22">
                             <div class="weui-col-15 text_center font_size_5"  style="opacity: 0">
                                 我
                             </div>

                             <div class="weui-col-55 text_center">
                                 <div class="rank_img crruent_user_headimgurl" style="">
                                     <img class="" src="/static/avatar/100445.jpg" style="width: 100%;opacity: 0">
                                 </div>
                                 <div class="rank_name text_left">
                                     <p class="p_overflow font_size_5 crruent_user_name" style="line-height: 0.8rem;height: 0.8rem;margin-top: 0.4rem;">小娃娃</p>
                                     <p class="p_overflow font_size_5 crruent_user_rank" style="line-height: 0.8rem;height: 0.8rem;">第10+名</p>
                                 </div>
                             </div>

                             <div class="weui-col-30 text_center height_22 text_right">
                                 <p class="p_overflow height_22 crruent_user_rank_time padding_R_10">05:00:00</p>
                             </div>

                        </div>

                        <!-- 排行-->
                        <div class="rank_4_box">
                            <!-- 暂无人上榜 -->
                            <div class="weui-row weui-no-gutter rank_border_bottom height_22 nodata" style="display: none">
                                <div class="weui-col-20 text_center font_size_6 height_22 position_relative rank_ranking">

                                 </div>

                                <div class="weui-col-60 text_center">
                                    暂无人上榜
                                 </div>

                                <div class="weui-col-20 text_center height_22 text_right">

                                 </div>
                            </div>

                        </div>
                    </div>

                </div>

                <div id="tab2" class="weui-tab__bd-item  weui-tab__bd-item--active">

                    <!-- 动态 切换 tab-->
                    <div class="weui-flex font_size_6" style="margin-top: 10px;height: 30px;line-height: 30px;margin-left:60px;margin-right: 60px">
                        <div class="weui-flex__item load_comments text_center load_comments_active" data-sta="1">
                            所有
                        </div>
                        <div class="weui-flex__item load_comments text_center" data-sta="2">
                            个人
                        </div>
                        <div class="weui-flex__item load_comments text_center" data-sta="3">
                            知识
                        </div>
                        <div class="weui-flex__item load_comments text_center" data-sta="4">
                            平台
                        </div>
                    </div>

                    <!-- 所有 动态 -->
                    <div class="bd fadeInLeft_1 load_comments_1 load_comments_box" style="z-index: 0">
                        <div class="page__bd" style="z-index: 0">

                        <!-- 推荐 分享 -->
                            <div class="weui-cells infinite content-padded" style="margin: 0;">

                                <div id="list">
                                    <div class="weui-col-60 text_center nodata" style="display: none;margin:20px auto">
                                        暂无人记录
                                    </div>

                                </div>

                                <div class="weui-loadmore">
                                    <i class="weui-loading"></i>
                                    <span class="weui-loadmore__tips">正在加载</span>
                                </div>


                            </div>

                        </div>
                    </div>

                    <!-- 个人 动态 -->
                    <div class="bd fadeInLeft_1 load_comments_2 load_comments_box" style="z-index: 0;display: none">
                        <div class="page__bd" style="z-index: 0">

                        <!-- 推荐 分享 -->
                            <div class="weui-cells content-padded" style="margin: 0;">

                                <div id="my_list">
                                    <div class="weui-col-60 text_center nodata" style="display: none;margin:20px auto">
                                        暂无人记录
                                    </div>
                                </div>

                                <!--
                                <div class="weui-loadmore hide" >
                                    <i class="weui-loading"></i>
                                    <span class="weui-loadmore__tips">正在加载</span>
                                </div>
                                -->

                            </div>
                        </div>
                    </div>

                    <!-- (知识) 动态 -->
                    <div class="bd fadeInLeft_1 load_comments_3 load_comments_box" style="z-index: 0;display: none">
                        <div class="page__bd" style="z-index: 0">

                        <!-- 推荐 分享 -->
                            <div class="weui-cells content-padded" style="margin: 0;">

                                <div id="knowledge_list">
                                    <div class="weui-col-60 text_center nodata hide" style="display: none;margin:20px auto">
                                        暂无人记录
                                    </div>
                                    <div style="padding: 20px">
                                        <p class="font_color_1">跑步动作</p>
                                        <div style="">
                                            <p class="font_size_6">&#12288;&#12288;跑步是一门学问，最科学的锻炼方法才能达到最好的效果。</p>
                                            <p class="font_size_7">1、头和肩</p>
                                            <p class="font_size_6">&#12288;&#12288;跑步动作要领——保持头与肩的稳定。头要正对前方，除非道路不平，不要前探，两眼注视前方。肩部适当放松，避免含胸。</p>
                                            <p class="font_size_6">&#12288;&#12288;动力伸拉——耸肩。肩放松下垂，然后尽可能上耸，停留一下，还原后重复。</p>
                                            <br>
                                            <p class="font_size_7">2、臂与手</p>
                                            <p class="font_size_6">&#12288;&#12288;跑步动作要领—摆臂应是以肩为轴的前后动作，左右动作幅度不超过身体正中线。手指、腕与臂应是放松的，肘关节角度约为90度。前摆时稍向内，后摆时稍向外。</p>
                                            <p class="font_size_6">&#12288;&#12288;动力伸拉——抬肘摆臂。两臂一前一后成预备起跑姿势，后摆臂肘关节尽量抬高，然后放松前摆。随着动作加快时越抬越高。</p>
                                            <br>
                                            <p class="font_size_7">3、躯干与髋</p>
                                            <p class="font_size_6">&#12288;&#12288;跑步动作要领——从颈到腹保持直立，而非前倾（除非加速或上坡）或后仰，这样有利于呼吸、保持平衡和步幅。
                                                躯干不要左右摇晃或上下起伏太大。腿前摆时积极送髋，跑步时要注意髋部的转动和放松。
                                            <p class="font_size_5">&#12288;&#12288;动力伸拉——弓步压腿。两腿前后开立，与肩同宽，身体中心缓慢下压至肌肉紧张，然后放松还原。躯干始终保持直立。</p>
                                            <br>
                                            <p class="font_size_7">4、腰</p>
                                            <p class="font_size_6">&#12288;&#12288;跑步动作要领——腰部保持自然直立，不宜过于挺直。肌肉稍微紧张，维持躯干姿势，同时注意缓冲脚着地的冲击。</p>
                                            <p class="font_size_6">&#12288;&#12288;动力伸拉——体前屈伸。自然站立，两脚开立，与肩同宽。躯干缓慢前屈至两手下垂至脚尖，保持一会儿，然后复原。</p>
                                            <br>
                                            <p class="font_size_7">5、大腿与膝</p>
                                            <p class="font_size_6">&#12288;&#12288;跑步动作要领——大腿和膝用力前摆，而不是上抬。腿的任何侧向动作都是多余的，而且容易引起膝关节受伤，因此大腿的前摆要正。</p>
                                            <p class="font_size_6">&#12288;&#12288;动力拉伸——前弓身．两脚站距同髋宽．双手放在头后．从髋关节屈体向前．保持腰背挺直，直到股二头肌感到紧张。</p>
                                            <br>
                                            <p class="font_size_7">6、小腿与跟腱</p>
                                            <p class="font_size_6">&#12288;&#12288;跑步动作要领——脚应落在身体前约一尺的位置，靠近正中线。小腿不宜跨得太远，避免跟腱因受力过大而劳损。同时要注意小腿肌肉和跟腱在着地时的缓冲，落地时小腿应积极向后扒地，使身体积极向前。
                                                另外，小腿前摆方向要正，脚应该尽量朝前，不要外翻或后翻，否则膝关节和踝关节容易受伤。可在沙滩上跑步时检查脚印以作参考。</p>
                                            <p  class="font_size_6">&#12288;&#12288;动力伸拉——撑壁提踵。面向墙壁约1米左右站立，两臂前伸与肩同宽，手撑壁。提踵，再放下，感觉小腿和跟腱紧张。</p>
                                            <br>
                                            <p class="font_size_7">7、脚跟与脚趾</p>
                                            <p class="font_size_6">&#12288;&#12288;跑步动作要领——如果步幅过大，小腿前伸过远，会以脚跟着地，产生制动刹车反作用力，对骨和关节损伤很大。正确的落地时用脚的中部着地，并让冲击力迅速分散到全脚掌。</p>
                                            <p class="font_size_6">&#12288;&#12288;动力伸拉——坐式伸踝．跪在地上，臀部靠近脚跟，上体保持直立．慢慢向下给踝关节压力直到趾伸肌与脚前掌感到足够拉力．然后抬臀后重复．动作要有节奏，缓慢。</p>
                                            <br>
                                        </div>
                                        <p class="font_color_1">运动技巧</p>
                                        <div style="">
                                            <p class="font_size_7">1、落地缓冲</p>
                                            <p class="font_size_6 text_indent">
                                                如果你有仔细观察过他人跑步，你会发现，很多人都是全脚掌着地，落地时的声音也比较大。正确的动作是在跑步时，腾空脚落地时要中位脚先着地，脚掌就不要着地。这是对于脚踝、膝盖的一种保护，防止骨膜炎的发生。
                                            </p>
                                            <br>
                                            <p class="font_size_7">2、摆臂</p>
                                            <p class="font_size_6 text_indent">
                                                摆臂是在跑步过程当中，保持身体的平衡性和协调性，使身体更自然的摆动，更符合人体运动的韵律。摆臂时，只要记住前不露肘，后不露手，自然的随着脚步而摆动。
                                            </p>
                                            <br>
                                            <p class="font_size_7">3、抬头挺胸</p>
                                            <p class="font_size_6 text_indent">
                                                跑步是保持抬头挺胸有助于改善人体的呼吸循环系统以及建立正常的记住状态。因为你在跑步过程中，人体在不断的消耗能量，易出现疲劳状况，这时如果你能用你的意志挺起你的脊梁，那么你要改善驼背状况其实就很简单了。
                                            </p>
                                            <br>
                                            <p class="font_size_7">4、呼吸</p>
                                            <p class="font_size_6 text_indent">
                                                跑步时的呼吸是深远而悠长的，一般采用鼻吸嘴呼，体力下降较为严重时可以采用嘴吸嘴呼方式。
                                            </p>
                                            <br>
                                            <p class="font_size_7">5、心率</p>
                                            <p class="font_size_6 text_indent">
                                                慢跑作为一种养生的有氧运动，就要和快速跑区分开来。一般来说，最适合身体锻炼的心率律动次数是：(220-年龄)×60%左右。大家跑步的时候可以适当的测量以下。
                                            </p>
                                            <br>
                                            <p class="font_size_7">6、头与肩</p>
                                            <p class="font_size_6 text_indent">
                                                头与肩都要保持稳定。头要目视前方，下颚微收但不要低头。跑步时，肩先放松下垂，然后尽可能上耸，停留一下，恢复原来的姿势再重复。
                                            </p>
                                            <br>
                                            <p class="font_size_7">7、臂和手</p>
                                            <p class="font_size_6 text_indent">
                                                手要微微握住，大小臂屈成约90度，前后自然摆动。要注意向前的手臂不要露肘，向后的手臂不要露出手来。
                                            </p>
                                            <br>
                                            <p class="font_size_7">8、腿</p>
                                            <p class="font_size_6 text_indent">
                                                用大腿带动小腿，膝关节要朝向脚尖方向，抬到合理的高度后放下再重复。
                                            </p>
                                            <br>
                                            <p class="font_size_7">9、双脚</p>
                                            <p class="font_size_6 text_indent">
                                                双脚要放松，不要紧缩脚趾，脚抬高到离地10厘米就可放下重复。脚掌落地时前脚掌不要太用力蹬地，以免造成小腿肌肉发达。
                                            </p>
                                            <br>

                                        </div>


                                    </div>






                                </div>

                            </div>

                        </div>
                    </div>

                    <!-- 平台(知识) 动态 -->
                    <div class="bd fadeInLeft_1 load_comments_4 load_comments_box" style="z-index: 0;display: none">
                        <div class="page__bd" style="z-index: 0">

                            <div class="weui-cells infinite content-padded" style="margin: 0;">

                                <div id="">
                                    <div class="weui-col-60 text_center nodata" style="margin:20px auto">
                                        待开放
                                    </div>

                                </div>

                            </div>

                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

<!--------------动态 end ----------------------------------------------->

    <!--上传任务弹出框-->
    <!--  上传1 张 图片-->
        <div id="upload-popup" class="weui-popup__container popup-bottom">
            <div class="weui-popup__overlay"></div>

            <div class="container">
                <div class="weui-popup__modal one">
                    <div class="modal-content">
                        <div class="row-center center" id="upload-popup__distance-panel" style="height: 50px;justify-content:inherit;overflow: hidden;z-index: 99999999999999999;">
                            {% if goal.goal_type == 0 %}
                            <span style="font-size: 0.8rem;font-weight: 600;display: inline-block;width: 100px;line-height: 50px;height: 50px;overflow: hidden">公里数</span>

                            <div class="row-center center" style="height: 50px;line-height: 50px;overflow: hidden;z-index: 99999999999999999;">
                                <div class="mdl-textfield mdl-js-textfield" id="upload-popup__distance-text">
                                    <input class="mdl-textfield__input" type="number" id="page-input" max="100" style="text-align: center;z-index: 99999">
                                    <label class="mdl-textfield__label" for="upload-popup__distance-input"></label>
                                </div>
                                <span class="panel__target-text__side">km</span>
                            </div>
                            {% else %}
                            <span style="font-size: 0.8rem;font-weight: 600;display: inline-block;width: 100px;line-height: 50px;height: 50px;overflow: hidden">公里数</span>

                            <div class="row-center center" style="height: 50px;line-height: 50px;overflow: hidden">
        {#                        <input class="mdl-textfield__input" type="number" id="page-input" max="100" value="{{ goal.kilos_day }}"  style="text-align: center;max-width: 80px;">#}
{#                                <span id="page-input" style="margin-right: 10px;text-align: center">{{ goal.kilos_day }}</span>#}
                                <input class="mdl-textfield__input" type="number" id="page-input" max="100" value="{{ goal.kilos_day }}" style="text-align: center;z-index: 99999">
                                <span class="panel__target-text__side">km</span>
                            </div>
                            {% endif %}
                        </div>

                        <div style="overflow: hidden;border-bottom: 1px solid  #ededed;width: 80%;margin: 0 auto;height: 70px;">
                            <textarea class="weui-textarea" id="document_text" placeholder="写下此刻的感想与收获吧..." rows="3" style="margin: 10px auto;font-size: 13px;z-index: 99999"></textarea>
                        </div>

                    <style>
                        #sourceNode{
                            display: none;
                        }
                    </style>
                        <div id="" style="height:auto;overflow: hidden;margin:10px auto;width:80%;">
                            <div class="news-item__content" style="height: 120px;margin-left: 0;">
                                <div class="weui-uploader__bd">
                                    <ul class="weui-uploader__files" id="uploaderFiles">
                                        <li class="uploaderInput_box" id="sourceNode" style="float: left;width: 30%;margin-left:1%;height: 60px;background: url(/static/order/demo.png) center no-repeat;background-size: cover;">
                                            <div class="weui-cell__ft img_remove">
                                                <i class="iconfont icon-guanbi font_red_1" style="line-height: 20px;height: 20px;font-size: 20px"></i>
                                            </div>
                                            <img class="news-item__content-img uploaderInput_img_1 box_content"
                                                 src="/static/order/demo.png" style="width: 60px;height: 60px;display: block;margin: auto;opacity: 0;display: none">
                                        </li>
                                    </ul>
                                    <div class="weui-uploader__input-box uploaderInput_input" style="width: 60px;height: 60px;margin-left: 5px;">
                                        <input id="uploaderInput" class="weui-uploader__input" type="file" accept="image/*">
                                    </div>

                                </div>
                            </div>
                        </div>

{#                        <div id="upload-image-panel" style="height: 200px;overflow: hidden;">#}
{#                            <img src="" id="upload_img_file" style="position: absolute;width: auto;height: 200px;z-index: 501;opacity: 0;" >#}
{#                            <!--#}
{#                            <p id="upload_img_file_p">+ 点击上传照片</p>#}
{#                            <input type="file" accept="image/*" multiple style="background-color: red;position: absolute;width: 1000px;height: 500px;opacity: 0;z-index: 5000;top: 0;left: 0;right: 0;bottom: 0;margin: auto;" >#}
{#                            -->#}
{#                            <div class="weui-uploader__input-box" id="upload_img_file_p" style="z-index: 99999999999999999999999;opacity: 1;width: 101%;border: none;height: 200px;">#}
{#                                <input id="uploaderInput" class="weui-uploader__input" type="file" accept="image/*" >#}
{#                            </div>#}
{#                        </div>#}
                        <div style="height: 40px;">

                        </div>
                        <button class="weui-btn weui-btn_primary" id="reading-confirm-btn" style="    position: absolute;bottom: 0;height: 40px;line-height: 40px;overflow: hidden">
                            确认
                        </button>
                    </div>
                </div>

                <div class="weui-popup__modal two" style="height: 60%;width: 60%;border: 1px solid white;">
                    <div style="position: relative;background: rgba(250,255,250,0);">
                        <img id="goal_img" src="/static/images/goal/1@2x.jpg" style="width: 100%">
                        <div style="position: absolute;bottom: 30px;right: 10px;width: 100px">
                            <img src="/static/images/goal/5732@2x.png" style="width: 100%;">
                        </div>
                        <div style="position: absolute;bottom: 40px;right: 10px;width: 100px;text-align: center;color: white;">
                            <p class="now_d">28</p>
                            <p class="now_m">28</p>
                        </div>
                        <div style="position: absolute;bottom: 10px;right: 10px;width: 100px;text-align: center;color: white;">
                            <p class="now_y">2018</p>
                        </div>
                    </div>

                    <div style="background: url('/static/images/goal/572@2x.png') no-repeat center;background-size: contain;width: 150px;height: 40px;line-height: 40px;display: block;margin: auto;">
                        <p style="text-align: center;height: 40px;line-height: 40px;font-size: 16px;">第 {{ punch_day|add:1 }} 天</p>
                    </div>

                    <div style="text-align: center;">
                        <p style="font-size: 10px;line-height: 20px;">{{ app.active_participants|default:0 }}正在参与</p>
                        <p style="font-size: 10px;line-height: 20px;">「跑步活动」</p>
                    </div>
                    <div style="display: block;width: 20%;margin: 10px auto 0px;">
                        <img id="share_1" src="/static/images/share/789@2x.png" style="width: 100%">
                    </div>

                </div>
            </div>

            <div sta="0" class="click_col"  style="width: 30px;display: block;margin: auto;position: absolute;bottom:50px;left: 0;right: 0;z-index: 999999999999999;">
                <img src="/static/images/goal/col.png" style="width: 100%;display: block;margin: auto;">
            </div>

        </div>

    <!-- 弹窗-->
    <div class="">


        <div class="mask_on" style="display: none"></div>
        <div class="mask_on_1" style="display: none"></div>
        <div class="mask_on__1" ></div>
        <div class="mask_on__container"></div>

        <div class="qqGroupCode_box" style="opacity: 0;display: block;width: 70%;">
            <div class="swiper-container_on_share_run">
                <div class="swiper-wrapper">
                    <!--
                    <div class="swiper-slide" data-link="#">
                        <img src="/static/images/on_share/on_share_run_1.jpg" style="width: 100%;" >
                    </div>
                     -->

                    <div class="swiper-slide" data-link="#">
                        <img src="/static/images/on_share/on_share_run_2.jpg" style="width: 100%;" >
                    </div>

                </div>
            </div>
        </div>
        <style>
            .activityDescription_box{
                overflow-y: scroll;
                width: 80%;
                padding: 10px;
                height: 80%;
            }
        </style>

        <div class="activityDescription_box" style="display: none">
            <div style="margin-bottom: 10px;">
                <img src="/static/images/running/run_notice.jpg" style="width: 100%">
                <!--
                <h4 style="text-align: center;margin: 5px auto 10px;">#跑步说明#</h4>
                <p style="font-size: 12px;line-height:18px;"><strong>自由模式：</strong><br>
                    用户需要在目标天数内每7天跑步累计目标距离，并可分为一次或多次完成累计。（每7天日结算）
                </p>

                <p style="font-size: 12px;line-height:18px;"><strong>日常模式：</strong><br>
                    用户需要在目标天数内每日完成目标距离，在活动中会有一次或多次免签机会。（每日根据打卡结算）
                </p>

                <p style="font-size: 12px;line-height:18px;">
                    每次记录都需上传一张图片作打卡记录，图片必须包含距离、速度、日期等基本信息。（跑步软件截图、跑步机照片均可。）跑步配速应在<u>2’02’’~12’00’’</u>之间，每次记录不得少于<u>1km</u>。每日<u>23:45</u>前需上传<u>当日</u>跑步记录，逾期不可补交。
                </p>
                <p style="font-size: 12px;line-height:18px;">
                    注：跑步机照片需添加时间水印，以免被举报或盗图。另外由于本活动或受天雨影响，因此用户也可在每日<u>18:00</u>前向客服申报获取免签等机会。（仅限<u>日常模式</u>，或收取一定费用。）（举报：当举报审核通过，或当日直接计为未完成。）
                </p>

                -->
            </div>
        </div>


        <!-- 押金 -->
        <div class="detailed_box_text"  style="display: none;width: 60%;">
            <p style="text-align: center;font-size: 16px">押金 <a href="https://mp.weixin.qq.com/s/e7LQzUe6DjaN9Zc9rjafFQ" style="color:rgba(31, 162, 255, 0.8);font-size: 12px;">（了解更多）</a></p>
            <div class="detailed_box__1">
                <div class="weui-flex">
                    <div class="weui-flex__item" style="padding-left: 10px;">
                        <p>&#12288;</p>
                        <p style="text-align: center">保证金</p>
                        <p style="text-align: center">底&#12288;金</p>
                    </div>
                    <div class="weui-flex__item">
                        <p  class="font_color_1">&#12288;</p>
                        <p><span class="">{{ goal.guaranty|floatformat:2 }}</span>元</p>
                        <p><span class="">{{ goal.down_payment|floatformat:2 }} </span>元</p>
                    </div>

                </div>
            </div>

        </div>

        <!-- 举报弹窗-->

        <div id="half" class='weui-popup__container popup-bottom'>
            <div class="weui-popup__overlay"></div>
            <div class="weui-popup__modal" style="background-color: rgba(229, 229, 229, 1);">
                <div class="toolbar" style="display: none">

                </div>
                <div class="modal-content"style="padding-top: 0rem;">
                    <div class="bg_white report-box-btn" style="line-height: 2.2rem;text-align: center;height: 2.2rem;display: none">
                        <a href="javascript:;" class="picker-button bg_white" style="display: block;width: 100%;color: black">
                            广告骚扰
                        </a>
                    </div>

                    <div class="bg_white report-box-btn" style="line-height: 2.2rem;text-align: center;height: 2.2rem;display: none;margin-top: 1px">
                        <a href="javascript:;" class="picker-button bg_white" style="display: block;width: 100%;color: black">
                            情色低俗
                        </a>
                    </div>

                    <div class="bg_white report-box-btn" style="line-height: 2.2rem;text-align: center;height: 2.2rem;display: none;margin-top: 1px">
                        <a href="javascript:;" class="picker-button bg_white" style="display: block;width: 100%;color: black">
                            钱财诈骗
                        </a>
                    </div>

                    <div class="bg_white report-box-btn" style="line-height: 2.2rem;text-align: center;height: 2.2rem;display: none;margin-top: 1px">
                        <a href="javascript:;" class="picker-button bg_white" style="display: block;width: 100%;color: black">
                            政治敏感
                        </a>
                    </div>

                    <div class="bg_white report-box-btn" style="line-height: 2.2rem;text-align: center;height: 2.2rem;display: none;margin-top: 1px">
                        <a href="javascript:;" class="picker-button bg_white" style="display: block;width: 100%;color: black">
                            跑步作弊
                        </a>
                    </div>

                    <div class="bg_white report-box" style="line-height: 2.2rem;text-align: center;height: 2.2rem;display: block">
                        <a href="javascript:;" class="picker-button bg_white" style="display: block;width: 100%;color: black">
                            举报
                        </a>
                    </div>


                    <div style="line-height: 2.2rem;text-align: center;height: 2.2rem;margin-top: 10px">
                        <a href="javascript:;" class="picker-button close-popup bg_white" style="display: block;width: 100%;color: black">
                            取消
                        </a>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div id="goal-id__get" hidden>{{ goal.goal_id }}</div>
    <script type="text/javascript" src="/static/js/jquery-2.1.4.js"></script>
    <script type="text/javascript" src="/static/js/jquery-weui-2.1.4.js"></script>
    <script type="text/javascript" src="/static/js/fastclick.js"></script>
    <script type="text/javascript" src="/static/js/public.js"></script>
{#	<script type="text/javascript" src="/static/js/jquery.min.js"></script>#}
{#	<script type="text/javascript" src="/static/js/fastclick.js"></script>#}
    <script type="text/javascript" src="http://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>

	<script>
		// fast click binding
		$(function () {
			FastClick.attach(document.body);
			$(".mask_on__1").hide();
			$(".qqGroupCode_box").hide();
			$(".qqGroupCode_box").css("opacity","1");

		});
		//去除广告
        $("#_embed_v3_dc").detach();
        $("iframe").detach();
	</script>

<!----    ajax 请求数据---------------------------------------->

        <!-- 排行榜 api/goal_ranking_list  -->
    <script>
        var u=0;
        rank();
        function rank() {
            u=u+1;
            if(u>5){
                return
            }
            $.ajax({
                type: "GET",
                url: "/api/goal_ranking_list",
                //url:"http://119.29.191.32/",
                data:{
                   "activity_type":1
                },
                success: function (res) {
                    //alert(res);
                    $.hideLoading();
                    console.log("排行榜");
                    console.log(res);
                    console.log("排行榜");

                    var add_data=res.run_list.add_data;
                    var lasting_data =res.run_list.lasting_data;
                    var week_data=res.run_list.week_data;
                    var bonus_data=res.run_list.bonus_data;
                    //console.log(sleep_list_morning);
                    //console.log(sleep_list_morning);
                    setTimeout(function () {
                        // 距离榜
                        fun_run_add_data(add_data);
                    }, 50);

                    setTimeout(function () {
                        // 周距离榜
                        fun_run_week_data(week_data);
                    }, 100);

                    setTimeout(function () {
                        // 坚持榜
                        fun_run_lasting_data(lasting_data);
                    }, 150);


                    setTimeout(function () {
                        // 收益榜
                        fun_run_bonus_rank(bonus_data)
                    }, 300);
                },
                error:function(res){
                    //console.log(res);
                    $.hideLoading();
                    setTimeout(function () {
                        //rank()
                    }, 100);
                },
                complete: function(XMLHttpRequest, textStatus) {
                    //console.log("ajax 公用");
                }
            });
        }

        // 距离榜
        function fun_run_add_data(add_data) {
            //console.log("早起榜");
            //console.log(morning);
            //console.log(morning.crruent_user);
            var current_user=add_data.current_user;
            var datas=add_data.datas;
            var current_user_rangking=Number(current_user.ranking);
            //console.log(current_user_rangking);
            $(".rank_1 .crruent_user_name").text(current_user.nickname);
            var current_user_get_up_time =current_user.add_distance;
            //console.log(current_user_get_up_time);
            if(current_user_get_up_time==''){
                $(".rank_1 .crruent_user_rank_time").text(current_user_get_up_time+" km");
            }else{
                $(".rank_1 .crruent_user_rank_time").text(current_user_get_up_time+" km");
            }


            var current_user_img='background-size: cover; background: url('+current_user.headimgurl+')  center;background-size: cover;background-repeat: no-repeat;';
            $(".rank_1 .crruent_user_headimgurl").attr("style",current_user_img);
            if(current_user_rangking == 0 || current_user_rangking==null || current_user_rangking == '' || current_user_rangking > 10  ){
                $(".rank_1 .crruent_user_rank").text("第10+名");
            }else{
                $(".rank_1 .crruent_user_rank").text("第"+current_user_rangking+"名");
            }

            //console.log(datas.length);
            if (datas.length == "0" || datas.length == 0) {
                //暂无人上榜
                $(".rank_1 .nodata").show();
            } else {
                $(".rank_1 .nodata").hide();

                for (var i = 0; i < datas.length; i++) {
                    //console.log(datas[i]);
                    var rank_ranking=i+1;
                    if(i == 0){
                        //console.log(datas[0]);
                        rank_ranking='<img src="/static/images/rank/1@2x.png"  class="box_content" style="">';
                    }else if(i == 1){
                        rank_ranking='<img src="/static/images/rank/2@2x.png"  class="box_content" style="">';
                    }else if(i == 2){
                        rank_ranking='<img src="/static/images/rank/3@2x.png"  class="box_content" style="">';
                    }else if(i>9){
                        return
                    }else{

                    }
                    var bg='background-size: cover; background: url('+datas[i].headimgurl+')  center;background-size: cover;background-repeat: no-repeat;'

                    var h=' <div class="weui-row weui-no-gutter rank_border_bottom height_22 ">\n' +
                        '       <div class="weui-col-15 text_center font_size_6 height_22 position_relative rank_ranking">\n' +
                        '        '+rank_ranking+'\n' +
                        '    </div>\n' +
                        '\n' +
                        '   <div class="weui-col-55 text_center">\n' +
                        '      <div class="rank_img" style="'+bg+'">\n' +
                        '           <img src="'+datas[i].headimgurl+'" style="width: 100%;opacity: 0;height: 100%;">\n' +
                        '       </div>\n' +
                        '       <div class="rank_name text_left">\n' +
                        '          <p class="p_overflow height_22 rank_name_">'+datas[i].nickname+'</p>\n' +
                        '      </div>\n' +
                        '    </div>\n' +
                        '\n' +
                        '    <div class="weui-col-30 text_center height_22 text_right">\n' +
                        '         <p class="p_overflow height_22 padding_R_10">'+datas[i].add_distance+' km</p>\n' +
                        '     </div>\n' +
                        ' </div>';
                    $(".rank_1_box").append(h);
                }
            }
        }

        // 周距离榜
        function fun_run_week_data(week_data) {
            //console.log("点赞榜");
            //console.log(watch_lists);
            //console.log(morning);
            //console.log(morning.crruent_user);
            var current_user=week_data.current_user;
            var datas=week_data.datas;
            var current_user_rangking=Number(current_user.ranking);
            //console.log(current_user_rangking);
            $(".rank_2 .crruent_user_name").text(current_user.nickname);
            $(".rank_2 .crruent_user_rank_time").text(current_user.week_distance+" km");

            if(current_user_rangking==0 || current_user_rangking==null || current_user_rangking==''|| current_user_rangking > 10  ){
                $(".rank_2 .crruent_user_rank").text("第10+名");
            }else{
                $(".rank_2 .crruent_user_rank").text("第"+current_user_rangking+"名");
            }

            var current_user_img='background-size: cover; background: url('+current_user.headimgurl+')  center;background-size: cover;background-repeat: no-repeat;';
            $(".rank_2 .crruent_user_headimgurl").attr("style",current_user_img);

            //console.log(datas.length);
            if (datas.length == "0" || datas.length == 0) {
                //暂无人上榜
                $(".rank_2 .nodata").show();
            } else {
                $(".rank_2 .nodata").hide();

                for (var i = 0; i < datas.length; i++) {
                    //console.log(datas[i]);
                    var rank_ranking=i+1;
                    if(i == 0){
                        //console.log(datas[0]);
                        rank_ranking='<img src="/static/images/rank/1@2x.png"  class="box_content" style="">';
                    }else if(i == 1){
                        rank_ranking='<img src="/static/images/rank/2@2x.png"  class="box_content" style="">';
                    }else if(i == 2){
                        rank_ranking='<img src="/static/images/rank/3@2x.png"  class="box_content" style="">';
                    }else if(i>9){
                        return
                    }else{

                    }
                    var bg='background-size: cover; background: url('+datas[i].headimgurl+')  center;background-size: cover;background-repeat: no-repeat;'

                    var h=' <div class="weui-row weui-no-gutter rank_border_bottom height_22 ">\n' +
                        '       <div class="weui-col-15 text_center font_size_6 height_22 position_relative rank_ranking">\n' +
                        '        '+rank_ranking+'\n' +
                        '    </div>\n' +
                        '\n' +
                        '   <div class="weui-col-55 text_center">\n' +
                        '      <div class="rank_img" style="'+bg+'">\n' +
                        '           <img src="'+datas[i].headimgurl+'" style="width: 100%;opacity: 0">\n' +
                        '       </div>\n' +
                        '       <div class="rank_name text_left">\n' +
                        '          <p class="p_overflow height_22 rank_name_">'+datas[i].nickname+'</p>\n' +
                        '      </div>\n' +
                        '    </div>\n' +
                        '\n' +
                        '    <div class="weui-col-30 text_center height_22 text_right">\n' +
                        '         <p class="p_overflow height_22 padding_R_10">'+datas[i].week_distance+' km</p>\n' +
                        '     </div>\n' +
                        ' </div>';
                    $(".rank_2_box").append(h);
                }
            }
        }

        // 坚持榜
        function fun_run_lasting_data(lasting) {
            //console.log("坚持榜");
            //console.log(lasting);
            //console.log(morning);
            //console.log(morning.crruent_user);
            var current_user=lasting.current_user;
            var datas=lasting.datas;
            var current_user_rangking=Number(current_user.ranking);
            //console.log(current_user_rangking);
            $(".rank_3 .crruent_user_name").text(current_user.nickname);
            $(".rank_3 .crruent_user_rank_time").text(current_user.punch_day+" 天");

            if(current_user_rangking==0 || current_user_rangking==null || current_user_rangking==''|| current_user_rangking > 10  ){
                $(".rank_3 .crruent_user_rank").text("第10+名");
            }else{
                $(".rank_3 .crruent_user_rank").text("第"+current_user_rangking+"名");
            }


            var current_user_img='background-size: cover; background: url('+current_user.headimgurl+')  center;background-size: cover;background-repeat: no-repeat;';
            $(".rank_3 .crruent_user_headimgurl").attr("style",current_user_img);

            //console.log(datas.length);
            if (datas.length == "0" || datas.length == 0) {
                //暂无人上榜
                $(".rank_3 .nodata").show();
            } else {
                $(".rank_3 .nodata").hide();

                for (var i = 0; i < datas.length; i++) {
                    //console.log(datas[i]);
                    var rank_ranking=i+1;
                    if(i == 0){
                        //console.log(datas[0]);
                        rank_ranking='<img src="/static/images/rank/1@2x.png"  class="box_content" style="">';
                    }else if(i == 1){
                        rank_ranking='<img src="/static/images/rank/2@2x.png"  class="box_content" style="">';
                    }else if(i == 2){
                        rank_ranking='<img src="/static/images/rank/3@2x.png"  class="box_content" style="">';
                    }else if(i>9){
                        return
                    }else{

                    }
                    var bg='background-size: cover; background: url('+datas[i].headimgurl+')  center;background-size: cover;background-repeat: no-repeat;'

                    var h=' <div class="weui-row weui-no-gutter rank_border_bottom height_22 ">\n' +
                        '       <div class="weui-col-15 text_center font_size_6 height_22 position_relative rank_ranking">\n' +
                        '        '+rank_ranking+'\n' +
                        '    </div>\n' +
                        '\n' +
                        '   <div class="weui-col-55 text_center">\n' +
                        '      <div class="rank_img" style="'+bg+'">\n' +
                        '           <img src="'+datas[i].headimgurl+'" style="width: 100%;opacity: 0">\n' +
                        '       </div>\n' +
                        '       <div class="rank_name text_left">\n' +
                        '          <p class="p_overflow height_22 rank_name_">'+datas[i].nickname+'</p>\n' +
                        '      </div>\n' +
                        '    </div>\n' +
                        '\n' +
                        '    <div class="weui-col-30 text_center height_22 text_right">\n' +
                        '         <p class="p_overflow height_22 padding_R_10">'+datas[i].punch_day+' 天</p>\n' +
                        '     </div>\n' +
                        ' </div>';
                    $(".rank_3_box").append(h);
                }
            }
        }

        // 收益榜
        function fun_run_bonus_rank(bonus_rank) {
            //console.log("收益榜");
            //console.log(bonus_rank);
            //console.log(morning);
            //console.log(morning.crruent_user);
            var current_user=bonus_rank.current_user;
            var datas=bonus_rank.datas;
            var current_user_rangking=Number(current_user.ranking);
            //console.log(current_user_rangking);
            $(".rank_4 .crruent_user_name").text(current_user.nickname);
            $(".rank_4 .crruent_user_rank_time").text(current_user.bonus+" 元");

            if(current_user_rangking==0 || current_user_rangking==null || current_user_rangking=='' || current_user_rangking > 10 ){
                $(".rank_4 .crruent_user_rank").text("第10+名");
            }else{
                $(".rank_4 .crruent_user_rank").text("第"+current_user_rangking+"名");
            }


            var current_user_img='background-size: cover; background: url('+current_user.headimgurl+')  center;background-size: cover;background-repeat: no-repeat;';
            $(".rank_4 .crruent_user_headimgurl").attr("style",current_user_img);

            //console.log(datas.length);
            if (datas.length == "0" || datas.length == 0) {
                //暂无人上榜
                $(".rank_4 .nodata").show();
            } else {
                $(".rank_4 .nodata").hide();
                for (var i = 0; i < datas.length; i++) {
                    //console.log(datas[i]);
                    var rank_ranking=i+1;
                    if(i == 0){
                        //console.log(datas[0]);
                        rank_ranking='<img src="/static/images/rank/1@2x.png"  class="box_content" style="">';
                    }else if(i == 1){
                        rank_ranking='<img src="/static/images/rank/2@2x.png"  class="box_content" style="">';
                    }else if(i == 2){
                        rank_ranking='<img src="/static/images/rank/3@2x.png"  class="box_content" style="">';
                    }else if(i>9){
                        return
                    }else{

                    }
                    var bg='background-size: cover; background: url('+datas[i].headimgurl+')  center;background-size: cover;background-repeat: no-repeat;'

                    var h=' <div class="weui-row weui-no-gutter rank_border_bottom height_22 ">\n' +
                        '       <div class="weui-col-15 text_center font_size_6 height_22 position_relative rank_ranking">\n' +
                        '        '+rank_ranking+'\n' +
                        '    </div>\n' +
                        '\n' +
                        '   <div class="weui-col-55 text_center">\n' +
                        '      <div class="rank_img" style="'+bg+'">\n' +
                        '           <img src="'+datas[i].headimgurl+'" style="width: 100%;opacity: 0">\n' +
                        '       </div>\n' +
                        '       <div class="rank_name text_left">\n' +
                        '          <p class="p_overflow height_22 rank_name_">'+datas[i].nickname+'</p>\n' +
                        '      </div>\n' +
                        '    </div>\n' +
                        '\n' +
                        '    <div class="weui-col-30 text_center height_22 text_right">\n' +
                        '         <p class="p_overflow height_22 padding_R_10">'+datas[i].bonus+' 元</p>\n' +
                        '     </div>\n' +
                        ' </div>';
                    $(".rank_4_box").append(h);
                }
            }
        }

        // 排行榜 却换
        $(".rank_change").click(function () {
            $(".rank_change").removeClass("rank_change_active");
            $(this).addClass("rank_change_active");
            var sta =Number($(this).attr("data-sta"));
            $(".rank_box").hide();
            $(".rank_"+sta).show();
        });

        //动态切换
        $(".load_comments").click(function () {
            $(".load_comments").removeClass("load_comments_active");
            $(this).addClass("load_comments_active");
            var sta =Number($(this).attr("data-sta"));
            $(".load_comments_box").hide();
            $(".load_comments_"+sta).show();
        })

    </script>

    <!-- 跑步 滚动 加载 -->
    <script>
        var has_next=0;
        var c_num=0;
        var loading = false;
        var my_id="{{ goal.user_id }}";

        //调用 所有动态 获取ajax 方法
        ajax_api_load_comments(0);

        //调用 个人动态 获取ajax 方法
        ajax_api_load_mine();

        //个人动态 ajax 请求
        function ajax_api_load_mine() {
            $.ajax({
                type: "POST",
                url: "/api/load_mine",
                data:{
                    "activity_type":1,
                    //"c_num":num
                },
                success: function (res) {
                    //alert(res);
                    $.hideLoading();
                    var finish=res.finish;
                    var datas=res.mine;
                    //console.log("--------------------------自己---------------------------");
                    //console.log(res);
                    //console.log(datas);
                    //console.log("--------------------------自己---------------------------");

                    //has_next=res.has_next;
                    //console.log(has_next);
                    //c_num=finish;

                    if(datas==null || datas=="" || datas=="[]"){
                        $("#my_list .nodata").show();
                    }else{
                        $("#my_list .nodata").hide();
                        my_list_show(datas);
                    }

                },
                error:function(res){
                    //console.log("报错");
                    //console.log(res);
                    $.hideLoading();

                },
                complete: function(XMLHttpRequest, textStatus) {
                    //console.log("ajax 公用");
                }
            });
        }

        //所有动态 ajax 请求
        function ajax_api_load_comments(num) {
            //console.log(num);
            $.ajax({
                type: "POST",
                url: "/api/load_comments",
                data:{
                    "activate_type":1,
                    "c_num":num
                },
                success: function (res) {
                    //alert(res);
                    $.hideLoading();
                    //console.log("--------------------------评论包---------------------------");
                    //console.log(res);
                    //console.log("--------------------------评论包---------------------------");
                    var finish=res.finish;
                    var datas=res.cont;
                    has_next=res.has_next;
                    //console.log(has_next);
                    c_num=finish;
                    if(has_next==1){

                    }else{
                        $(".weui-loadmore").hide();
                    }
                    if(datas==null || datas=="" || datas=="[]"){
                        $("#list .nodata").show();
                    }else{
                        $("#list .nodata").hide();
                        list_show(datas);
                    }

                },
                error:function(res){
                    //console.log("报错");
                    //console.log(res);
                    $.hideLoading();

                },
                complete: function(XMLHttpRequest, textStatus) {
                    //console.log("ajax 公用");
                }
            });
        }


        //个人动态
        function my_list_show(a) {
            //console.log(typeof(a));
            //console.log("个人动态");
            //console.log(a.isArray());
            var datas=JSON.parse(a);
            //var datas=JSON.stringify(a);
            //var datas = a;
            //console.log(datas);

             if (datas.length == "0" || datas.length == 0) {
                //暂无人上榜
             } else {

                 for (var i = 0; i < datas.length; i++) {
                     var data = datas[i];
                     //console.log("-----------------------------");
                     //console.log(data);
                     //console.log("-----------------------------");
                     var h;
                     var punch_id = String(data.punch_id).replace(/-/g, "");
                     //console.log(punch_id);
                     var c_time = data.c_time.substring(5, 16).replace("-", "月").replace(" ", "日 ");
                     var header_img = data.headimgurl;
                     var nickname = data.nickname;
                     var user_id = data.user_id;
                     var content = data.content;
                     var distance =data.distance;


                     //var replyComments = 'onclick=replyComments("' + punch_id + '")';
                     var replyComments = '';

                      // 点赞 块
                     var praise_box = '';
                     var is_no_prise = data.is_no_prise;
                     var praise = data.prise;
                     //console.log(praise);
                     if (is_no_prise == 0) {
                         var cccc = '';
                         if (praise == 0) {
                             cccc = ''
                         } else {
                             cccc = praise;
                         }
                         praise_box = praise_box + '<button href="javascript:;" class="news-item__tail-btn weui-flex__item parise-btn weui-flex__item_1_2 button_sty"\n' +
                             'punch_id="' + punch_id + '" sta="' + praise + '" style="border: 0px;">\n' +
                             '<i class="iconfont icon-dianzan"></i>\n' +
                             '<span class="news-item__tail-text">\n' +
                             '<span class="praise">\n' +
                             cccc +
                             '</span>\n' +
                             '</span>\n' +
                             '</button>\n';
                     } else {
                         praise_box = praise_box + '<button href="javascript:;" class="news-item__tail-btn weui-flex__item active weui-flex__item_1_2 button_sty_yes" disabled="disabled" style="border: 0px;">\n' +
                             '    <i class="iconfont icon-dianzan"></i>\n' +
                             '    <span class="news-item__tail-text">\n' +
                             '      <span class="praise">\n' +
                             praise +
                             '      </span>\n' +
                             '    </span>\n' +
                             '</button>\n'
                     }

                     // 点赞 块-----------------end

                     // 举报 块
                     var report_box = '';
                     var is_no_report = data.is_no_report;
                     var report = data.report;
                     //console.log(praise);

                      report_box = report_box + '<button href="javascript:;" class="news-item__tail-btn  more-btn button_sty open-popup" data-target="#half"   data-is_no_report="'+is_no_report+'" data-punch_id="'+punch_id+'" style="">\n' +
                             '                           <i class="iconfont icon-more"></i>\n' +
                             //'                           <span class="news-item__tail-text" style="margin-left: 10px;">举报</span>\n' +
                             '                      </button>';
                      /*
                     if (is_no_report == 0) {

                         report_box = report_box + '<button href="javascript:;" class="news-item__tail-btn  report-btn button_sty" punch_id="'+punch_id+'" style="">\n' +
                             '                           <i class="iconfont icon-more"></i>\n' +
                             //'                           <span class="news-item__tail-text" style="margin-left: 10px;">举报</span>\n' +
                             '                      </button>';
                     } else {
                         report_box = report_box + '<button href="javascript:;" class="news-item__tail-btn  active button_sty_yes"\n' +
                             '         style="" disabled="disabled">\n' +
                             //'       <i class="iconfont icon-jubao"></i>\n' +
                             '     <span class="news-item__tail-text" style="margin-left: 10px;">已举报</span>\n' +
                             '  </button>'
                     }
                     */
                     // 举报 块-----------------end

                     // 图片展示 块
                     var voucher_ref = data.voucher_ref;
                     var voucher_ref_img_box = '';
                     if (voucher_ref.length == "0" || voucher_ref.length == 0) {

                     } else {
                         for (var j = 0; j < voucher_ref.length; j++) {
                             var voucher_ref_img = voucher_ref[j];
                             //console.log(voucher_ref_img);
                             voucher_ref_img_box = voucher_ref_img_box + ' <div class="uploaderInput_box_" style="margin-top: 10px;display: block;float: left;\n' +
                                 '     background: url(' + voucher_ref_img + ') center;\n' +
                                 '     background-size: cover;\n' +
                                 '     background-repeat: no-repeat;">\n' +
                                 '         <img class="news-item__content-img box_left voucher_ref_img pictureEnlarge" style="position: absolute;opacity: 0;height:100%;" src="' + voucher_ref_img + '">\n' +
                                 '   </div>\n';
                         }
                     }
                     // 图片展示 块-----------------end


                     // 其他用户回复 块
                     var reply_data_box = '';
                     var reply_data_ = data.reply_data;
                     //console.log(reply_data_);

                     if (reply_data_.length == "0" || reply_data_.length == 0) {

                     } else {
                         for (var l = 0; l < reply_data_.length; l++) {
                             var reply_data__ = reply_data_[l];
                             //console.log(reply_data__);
                             //console.log("--------------------------------------------------------------");
                             reply_data_box = reply_data_box + '<p class="word_break" style="color: #333333;"><span class="news-item__header-text" style="margin-left: 0;">' + reply_data__.nickname + '</span>：<span style="color: #4a4a4a;">' + reply_data__.content + '</span></p>';
                         }
                     }
                     // 其他用户回复 块-----------------end

                     h = '                <ul class="news-list">\n' +
                             '                    <li class="news-item" data-punch="' + punch_id + '" style="overflow:hidden;">\n' +
                             '                        <div class="new-item__content">\n' +
                             '                            <div>\n' +
                             '                                <img src="' + header_img + '" class="news-item__header-img pictureEnlarge">\n' +
                             '                                <span class="news-item__header-text">' + nickname + '</span>\n' +
                             '                                <span style="color: #B6C1C8;display: inline-block;">完成 <span class="font_orange_2">' + distance + '</span> km</span>\n' +
                             '                                 <span style="color: #B6C1C8;display: inline-block;float: right">'+c_time+'</span>\n' +
                             '                            </div>\n' +
                             '                            <div style="margin-left: 46px;">\n' +
                             '                                <p>' + content + '</p>\n' +
                             '                            </div>\n' +
                             '                            <div class="news-item__content" style="height: auto;margin-left: 36px;width: 90%">\n' +
                             voucher_ref_img_box +
                             '                            </div>\n' +
                             '                            <div class="reply_data clamp_5 reply_data_' + punch_id + '">\n' +
                             '                                <div style="margin-left: 46px;">\n' +
                             reply_data_box +
                             '                                </div>\n' +
                             '                            </div>\n' +
                             '                        </div>\n' +
                             '                        <div class="news-item__horzon"></div>\n' +
                             '                        <div class="weui-flex news-item__bottom" style="">\n' +
                             '                            <div class="weui-flex__item" style="padding-left: 50px;">\n' +
                             '                                <span class="hide" style="color: #B6C1C8;">' + c_time + '</span>\n' +
                             '                            </div>\n' +
                             '                            <div class="weui-flex__item weui-flex" style="flex: 2;">\n' +
                             praise_box +
                             '                                <button href="javascript:;" class="news-item__tail-btn weui-flex__item replyComments button_sty" ' + replyComments + ' punch_id="' + punch_id + '" style="">\n' +
                             '                                    <i class="iconfont icon-pinglun font_color_1"></i>\n' +
                             //'                                    <span class="news-item__tail-text">回复</span>\n' +
                             '                                </button>\n' +
                             report_box+
                             '                            </div>\n' +
                             '                        </div>\n' +
                             '                    </li>\n' +
                             '                </ul>\n';
                     $("#my_list").append(h);
                 }
                 //----- for 循环 end---------------------------------------------------
                 loading = false;
                 setTimeout(function () {
                     $('.weui-cell_swiped').swipeout();
                 }, 1000);
             }
        }

        //所有动态 ajax 数据 展示
        function list_show(a) {
            //console.log(typeof(a));
            //console.log("评论数据包");
            //console.log(a.isArray());
            var datas=JSON.parse(a);
            //var datas=JSON.stringify(a);
            //var datas = a;
            //console.log(datas);

             if (datas.length == "0" || datas.length == 0) {
                //暂无人上榜
             } else {

                 for (var i = 0; i < datas.length; i++) {
                     var data = datas[i];
                     //console.log("-----------------------------");
                     //console.log(data);
                     //console.log("-----------------------------");
                     var h;

                     var punch_id = String(data.punch_id).replace(/-/g, "");
                     //console.log(punch_id);
                     var c_time = data.c_time.substring(5, 16).replace("-", "月").replace(" ", "日 ");
                     var header_img = data.headimgurl;
                     var nickname = data.nickname;
                     var user_id = data.user_id;
                     var content = data.content;
                     var distance =data.distance;


                     //var replyComments = 'onclick=replyComments("' + punch_id + '")';
                     var replyComments = '';

                      // 点赞 块
                     var praise_box = '';
                     var is_no_prise = data.is_no_prise;
                     var praise = data.prise;
                     //console.log(praise);
                     if (is_no_prise == 0) {
                         var cccc = '';
                         if (praise == 0) {
                             cccc = ''
                         } else {
                             cccc = praise;
                         }
                         praise_box = praise_box + '<button href="javascript:;" class="news-item__tail-btn weui-flex__item parise-btn weui-flex__item_1_2 button_sty"\n' +
                             'punch_id="' + punch_id + '" sta="' + praise + '" style="border: 0px;">\n' +
                             '<i class="iconfont icon-dianzan"></i>\n' +
                             '<span class="news-item__tail-text">\n' +
                             '<span class="praise">\n' +
                             cccc +
                             '</span>\n' +
                             '</span>\n' +
                             '</button>\n';
                     } else {
                         praise_box = praise_box + '<button href="javascript:;" class="news-item__tail-btn weui-flex__item active weui-flex__item_1_2 button_sty_yes" disabled="disabled" style="border: 0px;">\n' +
                             '    <i class="iconfont icon-dianzan"></i>\n' +
                             '    <span class="news-item__tail-text">\n' +
                             '      <span class="praise">\n' +
                             praise +
                             '      </span>\n' +
                             '    </span>\n' +
                             '</button>\n'
                     }

                     // 点赞 块-----------------end

                     // 举报 块
                     var report_box = '';
                     var is_no_report = data.is_no_report;
                     var report = data.report;
                     //console.log(praise);
                     report_box = report_box + '<button href="javascript:;" class="news-item__tail-btn  more-btn button_sty open-popup" data-target="#half"  data-is_no_report="'+is_no_report+'" data-punch_id="'+punch_id+'" style="">\n' +
                             '                           <i class="iconfont icon-more"></i>\n' +
                             //'                           <span class="news-item__tail-text" style="margin-left: 10px;">举报</span>\n' +
                             '                      </button>';
                     /*
                     if (is_no_report == 0) {


                     } else {
                         report_box = report_box + '<button href="javascript:;" class="news-item__tail-btn  active button_sty_yes"\n' +
                             '         style="" disabled="disabled">\n' +
                             //'       <i class="iconfont icon-jubao"></i>\n' +
                             '     <span class="news-item__tail-text" style="margin-left: 10px;">已举报</span>\n' +
                             '  </button>'
                     }
                     */
                     // 举报 块-----------------end

                     // 图片展示 块
                     var voucher_ref = data.voucher_ref;
                     var voucher_ref_img_box = '';
                     if (voucher_ref.length == "0" || voucher_ref.length == 0) {

                     } else {
                         for (var j = 0; j < voucher_ref.length; j++) {
                             var voucher_ref_img = voucher_ref[j];
                             //console.log(voucher_ref_img);
                             voucher_ref_img_box = voucher_ref_img_box + ' <div class="uploaderInput_box_" style="margin-top: 10px;display: block;float: left;\n' +
                                 '     background: url(' + voucher_ref_img + ') center;\n' +
                                 '     background-size: cover;\n' +
                                 '     background-repeat: no-repeat;">\n' +
                                 '         <img class="news-item__content-img box_left voucher_ref_img pictureEnlarge" style="position: absolute;opacity: 0;height:100%;" src="' + voucher_ref_img + '">\n' +
                                 '   </div>\n';
                         }
                     }
                     // 图片展示 块-----------------end


                     // 其他用户回复 块
                     var reply_data_box = '';
                     var reply_data_ = data.reply_data;
                     //console.log(reply_data_);

                     if (reply_data_.length == "0" || reply_data_.length == 0) {

                     } else {
                         for (var l = 0; l < reply_data_.length; l++) {
                             var reply_data__ = reply_data_[l];
                             //console.log(reply_data__);
                             //console.log("--------------------------------------------------------------");
                             reply_data_box = reply_data_box + '<p class="word_break" style="color: #333333;"><span class="news-item__header-text" style="margin-left: 0;">' + reply_data__.nickname + '</span>：<span style="color: #4a4a4a;">' + reply_data__.content + '</span></p>';
                         }
                     }
                     // 其他用户回复 块-----------------end

                     h = '                <ul class="news-list">\n' +
                             '                    <li class="news-item" data-punch="' + punch_id + '" style="overflow:hidden;">\n' +
                             '                        <div class="new-item__content">\n' +
                             '                            <div>\n' +
                             '                                <img src="' + header_img + '" class="news-item__header-img pictureEnlarge">\n' +
                             '                                <span class="news-item__header-text">' + nickname + '</span>\n' +
                             '                                <span style="color: #B6C1C8;display: inline-block;">完成 <span class="font_orange_2">' + distance + '</span> km</span>\n' +
                            '                                 <span style="color: #B6C1C8;display: inline-block;float: right">'+c_time+'</span>\n' +
                             '                            </div>\n' +
                             '                            <div style="margin-left: 46px;">\n' +
                             '                                <p>' + content + '</p>\n' +
                             '                            </div>\n' +
                             '                            <div class="news-item__content" style="height: auto;margin-left: 36px;width: 90%">\n' +
                             voucher_ref_img_box +
                             '                            </div>\n' +
                             '                            <div class="reply_data clamp_5 reply_data_' + punch_id + '">\n' +
                             '                                <div style="margin-left: 46px;">\n' +
                             reply_data_box +
                             '                                </div>\n' +
                             '                            </div>\n' +
                             '                        </div>\n' +
                             '                        <div class="news-item__horzon"></div>\n' +
                             '                        <div class="weui-flex news-item__bottom" style="">\n' +
                             '                            <div class="weui-flex__item " style="padding-left: 50px;">\n' +
                             '                                <span class="hide" style="color: #B6C1C8;">' + c_time + '</span>\n' +
                             '                            </div>\n' +
                             '                            <div class="weui-flex__item weui-flex" style="flex: 2;">\n' +
                             praise_box +
                             '                                <button href="javascript:;" class="news-item__tail-btn weui-flex__item replyComments button_sty" ' + replyComments + ' punch_id="' + punch_id + '" style="">\n' +
                             '                                    <i class="iconfont icon-pinglun font_color_1"></i>\n' +
                             //'                                    <span class="news-item__tail-text">回复</span>\n' +
                             '                                </button>\n' +
                             report_box+
                             '                            </div>\n' +
                             '                        </div>\n' +
                             '                    </li>\n' +
                             '                </ul>\n';
                     $("#list").append(h);
                 }
                 //----- for 循环 end---------------------------------------------------
                 loading = false;
                 setTimeout(function () {
                     $('.weui-cell_swiped').swipeout();
                 }, 1000);
             }
        }

        //点赞
        $("body").on("click", ".parise-btn", function () {
        //$(".parise-btn").click(function () {
            $(this).addClass("active");
            var sta =Number($(this).attr("sta"))+1;
            //alert(sta)
            var parise_btn=$(this);
            var punch_id=$(this).attr('punch_id');
            //alert(punch_id);
            $.post('/api/running_praise',{
                punch:punch_id,
            },function (response) {
                parise_btn.find(".news-item__tail-text").css("color","#B6C1C8");
                parise_btn.css("color","rgb(182, 193, 200)");
                parise_btn.find(".news-item__tail-text").text(sta);
                //parise_btn.css("border","1px #B6C1C8 solid");
                parise_btn.removeClass("report-btn");
                parise_btn.attr("disabled","disabled");
            });
        });

        //举报
        $("body").on("click", ".report-box-btn", function () {
            var report_btn = $(this);
            //console.log(report_btn.parents(".news-item").data('punch'));
            var punch_id=$(this).attr('data-punch_id');
            //alert(punch_id);
            $.confirm({
                title: '举报',
                text: '确认举报该用户打卡记录不属实？举报后将有管理员进行审核',
                onOK: function () {
                    $.post('/api/running_report',{
                        punch:punch_id
                    },function (response) {
                        if(response['status'] === 200){
                            $.toast("举报成功");
                            $.closePopup();
                            //report_btn.css("color","#B6C1C8");
                            //report_btn.find(".news-item__tail-text").css("color","#B6C1C8");
                            //report_btn.find(".news-item__tail-text").text("已举报");
                            //report_btn.css("border","1px #B6C1C8 solid");
                            //report_btn.removeClass("report-btn");
                            //report_btn.attr("disabled","disabled");


                        }
                        else{
                            $.toast("举报失败<br/>请联系客服","cancel");
                            $.closePopup();
                        }
                    });
                }
            });
        });

        //更多
        $("body").on("click", ".more-btn", function () {
            var report_btn = $(this);
            //console.log(report_btn.parents(".news-item").data('punch'));
            var punch_id=$(this).attr('data-punch_id');
            var is_no_report=$(this).attr('data-is_no_report');
            //console.log(punch_id);
            //console.log(is_no_report);
            $(".report-box-btn").removeAttr("data-punch_id");
            $(".report-box").removeClass("report-box-click");
            $(".report-box").show();
            $(".report-box-btn").hide();

            if(is_no_report==0){
                //console.log("可以举报");
                $(".report-box").text("举报");
                $(".report-box-btn").attr("data-punch_id",punch_id);
                $(".report-box").addClass("report-box-click")
            }else if(is_no_report==1){
                console.log("已经举报");
                $(".report-box").text("已举报");
            }
            //alert(punch_id);
        });

        //$(".report-box-click").click(function () {
        $("body").on("click", ".report-box-click", function () {
            console.log("举报");
            $(".report-box").hide();
            $(".report-box-btn").show();
        });

        //回复
        //$(".replyComments").click(function () {
        $("body").on("click", ".replyComments", function () {
            var replyComments_other_id=$(this).attr("punch_id");
            console.log(replyComments_other_id);

            /*
            $.toast("你还未参加活动","cancel", function() {
                console.log("cancel");
            });
            */

            $.modal({
                title: "回复评论",
                text: '<div class="modalTextarea_box"><textarea class="modalTextarea" id="weui-prompt-input" rows="2"></textarea></div>',
                buttons: [
                    {
                        text: "取消",
                        className: "default"
                    },
                    {
                        text: "发送",
                        onClick: function (e) {
                            console.log(e);
                            var text = $(".modalTextarea").val();
                            //$.alert(text);
                            //console.log(text);
                            var len=text.length;
                            console.log(len);
                            if (text == "" || text == null) {
                                $.toptip('请输入回复内容！', 'error');
                                return
                            }
                            if (text.length >100) {
                                $.hideLoading();
                                $.toptip("不能超过100字", "error");
                                $("#document_text").focus();
                                return
                            }

                            replyComments_ajax(replyComments_other_id,text);
                        }
                    }
                ]
            })
        });
        // 回复 ajax
        function replyComments_ajax(other_id,text) {
            $.showLoading();
            $(".weui-toast_content").text("回复中...");
            console.log(other_id);
            console.log(text);
            //console.log({{ nickname }});

            $.ajax({
                type: "POST",
                url: "/api/run_reply",
                data:{
                    "other_id":other_id,
                    "r_content":text
                },
                success: function (res) {
                    //alert(res);
                    $.hideLoading();
                    console.log(res);
                    setTimeout(function () {
                        if(res.status=="403"){
                            $.toast("回复失败", "cancel");
                            return
                        }
                        var name='{{ nickname }}';
                        var a='<div style="margin-left: 46px;">' +
                            '<p class="word_break" style="color: #333333;"><span class="news-item__header-text" style="margin-left: 0;">'+name+'</span> ：<span style="color: #4a4a4a;">'+text+'</span></p>' +
                            '</div>';
                        $(".reply_data_"+other_id).append(a);
                        $.toast("回复成功",function () {
                        })
                    }, 500);
                },
                error:function(res){
                    console.log(res);
                    $.hideLoading();
                    setTimeout(function () {
                        $.toast("错误", "cancel");
                    }, 500);
                },
                complete: function(XMLHttpRequest, textStatus) {
                    console.log("ajax 公用");
                }
            });
        }

        // 回复 展开 更多
        $("body").on("click", ".reply_data", function () {
            //console.log("77777");
            $(this).toggleClass("clamp_5");
        });


        //滚动 加载 （核心）
        $(document.body).infinite().on("infinite", function() {
            $(".weui-loadmore").hide();
            if(loading) return;
            loading = true;
            if(has_next==1){
                //console.log("继续");
                $(".weui-loadmore").show();
                ajax_api_load_comments(c_num);
            }else{
                loading = false;
                $(".weui-loadmore").hide();
            }

        });
        $(document).ready(function(){
            //获取要定位元素距离浏览器顶部的距离
            var navH = $("#fixed_TOP").offset().top;
            //滚动条事件
            $(window).scroll(function(){
                //获取滚动条的滑动距离
                var scroH = $(this).scrollTop();
                //console.log(scroH);
                //滚动条的滑动距离大于等于定位元素距离浏览器顶部的距离，就固定，反之就不固定
                if(scroH>=navH){
                    $("#fixed_TOP").addClass("position_f_T_0");

                }else if(scroH<navH){
                    $("#fixed_TOP").removeClass("position_f_T_0");
                }
                //console.log(navH_2);
            });

        });
    </script>

<!----    ajax 请求数据 end---------------------------------------->

	<script type="text/javascript" src="http://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
    <script type='text/javascript' src='/static/js/swiper.min.js' charset='utf-8'></script>
    <script>
        var swiper_on_share = new Swiper('.swiper-container_on_share_run', {
            autoplay: true,
            loop:true,
        });
    </script>


    <!--配置CSRF保护-->
    <script>
        $.ajaxSetup({
            data: {csrfmiddlewaretoken: '{{ csrf_token }}' }
        });
    </script>
    <!--注入Config信息-->
	<script>
        {{ WechatJSConfig|safe}}

        var qrcode_url = "http://wechat.onmytarget.cn/static/images/logo/logo.png";
        //var qrcode_url="http://wechat.onmytarget.cn/static/images/on_logo.jpeg";
        var title="{{ nickname }}  邀请你参加跑步活动";
        var share_desc="On蜕变 一个好玩的平台";
        wx.ready(function() {
            //wx.hideAllNonBaseMenuItem();
            //wx.hideOptionMenu();
            wx.showMenuItems({
                menuList: ['onMenuShareAppMessage',
                           'onMenuShareTimeline'] // 要显示的菜单项，所有menu项见附录3
            });

            //分享到朋友圈
            wx.onMenuShareTimeline({
                title:title, // 分享标题
                desc: share_desc,
                link: 'http://wechat.onmytarget.cn/activity/32f2a8dbe89d43c7b9ecfea19947b057?usid={{ goal.user_id|default:100259 }}', // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致
                imgUrl:qrcode_url, // 分享图标
                success: function () {
                    $.toast("分享成功");
                    // 用户确认分享后执行的回调函数
                },
                cancel: function () {
                }
             });

            //分享到朋友
            wx.onMenuShareAppMessage({
                title: title, // 分享标题
                desc: share_desc, // 分享描述
                link: 'http://wechat.onmytarget.cn/activity/32f2a8dbe89d43c7b9ecfea19947b057?usid={{ goal.user_id|default:100259 }}', // 分享链接
                imgUrl: qrcode_url, // 分享图标
                type: '', // 分享类型,music、video或link，不填默认为link
                dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空
                success: function () {
                    $.toast("分享成功");
                    // 用户确认分享后执行的回调函数
                },
                cancel: function () {
                }
            });
        })

	</script>

    <script>
        $(document).ready(function(){
            //获取要定位元素距离浏览器顶部的距离
            var navH = $("#fixed_TOP").offset().top;
            //滚动条事件
            $(window).scroll(function(){
                //获取滚动条的滑动距离
                var scroH = $(this).scrollTop();
                //console.log(scroH);
                //滚动条的滑动距离大于等于定位元素距离浏览器顶部的距离，就固定，反之就不固定
                if(scroH>=navH){
                    $("#fixed_TOP").addClass("position_f_T_0");

                }else if(scroH<navH){
                    $("#fixed_TOP").removeClass("position_f_T_0");
                }
                //console.log(navH_2);
            });

          });

    </script>

    <script>
        var guaranty='{{ goal.guaranty|floatformat:2 }}';
        var down_payment ='{{ goal.down_payment|floatformat:2 }}'; //底金
        $("#guaranty_down_payment").text(parseFloat(Number(guaranty)+Number(down_payment)));

        var guaranty_new_coeff =Number($("#guaranty_new_coeff").text().trim());
		$("#guaranty_new_coeff").text(guaranty_new_coeff);

        // 切换天数显示
        var num = $(".today").attr("num").trim();
		$(".header_date").click(function () {
			// 如果不能点击，则不处理
			if($(this).hasClass("notouch")){
				return;
			}
			var old_num=num;
			num = $(this).attr("num").trim();
			$(".day-index").hide();
			$(".day-index").removeClass("fadeInRight_1");
			$(".day-index").removeClass("fadeInLeft_1");
			console.log("以前的"+old_num);
			console.log("现在的"+num);

			if(old_num==num){
			    console.log("不滑")
            }else if(num >old_num){

			    //$(".dayindex_" + old_num).addClass("fadeInLeft_1_hide");
			    //$(".dayindex_" + old_num).hide(1000);
			    $(".dayindex_" + num).addClass("fadeInRight_1");
			    console.log("右滑")
            }else if(num<old_num){

			    //$(".dayindex_" + old_num).addClass("fadeInRight_1_hide");
			    //$(".dayindex_" + old_num).hide(1000);
			    $(".dayindex_" + num).addClass("fadeInLeft_1");
			    console.log("左滑")
            }

			console.log(num);
			$(".header_date.active").removeClass("active");
			$(this).addClass("active");
			//$(".datespanel").hide();

            //$(".day-index").removeClass("fadeInRight_1_hide");
			//$(".day-index").removeClass("fadeInLeft_1_hide");
			$(".dayindex_" + num).show();
		});

        function uploadBtnFinish(text) {
            //alert(text);
            var upload_btn = $("#upload-btn");
            upload_btn.text(text);
            upload_btn.addClass("finish");
            upload_btn.attr({"disabled":"disabled"});
            $("#avoid-btn").hide();
            var datesdayindex = $("#datesdayindex").val();
            console.log(datesdayindex);
            $("#unfinishedTask_"+datesdayindex).text(text);
        }

        $("#backup-btn").click(function () {
            window.location.href = 'index';
        });

        //使用免签券
        $("#avoid-btn").click(function(){
            var count = parseInt($("#avoid-count").html());
            if(count > 0){
                $.confirm({
                title: '使用免签券',
                text: '一张券可以免签一次，确认使用？',
                    onOK: function () {
                    //$.showLoading();
                    //$(".weui-toast_content").text("免签券使用中...");
                        $("#avoid-count").html((count-1).toString());
                        $.ajax({
                            type: "post",
                            url: "/api/running_no_sign_in",
                            data:{
                                goal:$("#goal-id__get").html().trim()
                            },
                            success: function (res) {
                                console.log(res);
                                $.hideLoading();
                                //console.log("成功");
                                //console.log(res);
                                if(res.status == "200") {
                                    $.toast("免签成功", "success", function () {
                                        window.location.reload();
                                        uploadBtnFinish("已使用免签券抵消");
                                    });
                                }else{
                                    $.toast("操作失败","cancel");
                                }

                            },
                            error:function(res){
                                $.hideLoading();
                            }
                        })
                    }
                });
            }
            else{
                $.toast("免签券不够","cancel");
            }
        });

        //点击上传任务 签到 弹出窗口
        $("#upload-btn").click(function () {
            var Num=$(this).attr("Num");
            $("#reading-confirm-btn").attr("Num",Num);

            if(Num==2){
                var punch_id=$(this).attr("punch_id");
                $("#reading-confirm-btn").attr("punch_id",punch_id);
                var reload_Num=Number($(this).attr("reload"));
                var nn=3-reload_Num;
                if(reload_Num<3){
                    $.confirm("你还可以重新上传"+nn+"次！", function() {
                      //点击确认后的回调函数
                        $(".mask_on__container").show();
                        $("#upload-popup").popup();
                        $("body").addClass("popup-open");
                     }, function() {

                      //点击取消后的回调函数
                    });
                }else{
                    $.toast("无重新上传机会", "cancel");
                    return
                }
            }else{
                $(".mask_on__container").show();
                $("#upload-popup").popup();
                $("body").addClass("popup-open");
            }

            {% if goal.goal_type == 0 %}
                //自由模式
                $("#page-input").val("");
                $("#document_text").val("");
                //$("#upload-image-panel").html("<p>+ 点击上传照片</p>");
            {% else %}
                //日常模式
                //$("#page-input").val("");
                $("#document_text").val("");
                //$("#upload-image-panel").html("<p>+ 点击上传照片</p>");
            {% endif %}

        });

        //关闭 签到 弹出
        $(".weui-popup__overlay").click(function () {
            //console.log("关闭");
            $("body").removeClass("popup-open");
        });

        function initDateCss() {
            var header = $(".header_date");
            var width =  $(".row-center_1").width();
            header.css('width',width/8);
            //header.css('height',width/8);
            //header.css('lineHeight', width/8 +"px");
        }

        $(document).ready(function () {
            initDateCss();
        });


    </script>

    <!-- 弹窗 -->
    <script>
        $(function() {
            var swiper_1 = new Swiper('.swiper-container_1', {
                autoplay: false,
                loop:false,
                initialSlide :100
            });


            //打卡说明
            $("#activityDescription_but").click(function () {
                $(".activityDescription_box").show();
                $(".mask_on").show();
                $("body").addClass("popup-open");
            });

            //添加QQ 群
            $("#qqGroupCode").click(function () {
                $(".qqGroupCode_box").show();
                $(".mask_on").show();
                $("body").addClass("popup-open");
            });
            //detailed_box_text_but
            $("#detailed_box_text_but").click(function () {
                $(".detailed_box_text").show();
                $(".mask_on").show();
                $("body").addClass("popup-open");
            });

            //关闭弹窗
            $(".mask_on").click(function () {
                $(".rule_box_text").hide();
                $(".detailed_box_text").hide();
                $(".qqGroupCode_box").hide();
                $(".activityDescription_box").hide();
                $(this).hide();
                $("body").removeClass("popup-open");
            });

            $(".mask_on__1").click(function () {
                $(".qqGroupCode_box").hide();
                $(".qqGroupCode_box").css("opacity","1");
                $(this).hide();
                $("body").removeClass("popup-open");
            });

        });

    </script>
    <!-- 获取擂主押金 -->
    <script>
         //指定10秒刷新一次
         //search_deposit();
        function search_deposit() {
            //console.log("获取擂主押金");
            setTimeout('search_deposit()',100000);
            $.ajax({
                type: "GET",
                url: "/api/search_deposit",
                data:{
                },
                success: function (res) {
                    $.hideLoading();
                    $(".challenger_deposit").hide();
                    //console.log("成功");
                    //console.log(res);
                    if(res.status == "200"){
                        var data=String(parseInt(res.winner));
                        var wwww=Number({{ app.bonus_all|floatformat:"0" }});
                        //console.log(wwww);
                        var uuuuu=Number(res.winner)+wwww-10000;
                        //console.log(uuuuu);
                        //$("#app_bonus_all").text(uuuuu);

                        //console.log(data);
                        var winner=data.split("");
                        //console.log(winner.length);
                        var l=winner.length-1;
                        //console.log(l);
                        for (var i=l;i>=0;i--) {
                            //console.log("i"+i);

                            $(".challenger_deposit_"+i).parent().show();
                            $(".challenger_deposit_"+i).text(winner[i]);
                        }
                    }else if (res.status == "403"){
                        $(".challenger_deposit_"+1).parent().show();
                        $(".challenger_deposit_"+1).text(0);
                    }else{
                        $(".challenger_deposit_").parent().hide();
                    }

                    //console.log(res.winner.toString(0));
                },
                error:function(res){
                    $.hideLoading();
                    //console.log("错误");
                    //console.log(res);
                    $(".challenger_deposit_").parent().hide();
                }
            })
        }

    </script>

    <!--  图片放大  -->
    <script>
        {% if goal.goal_type == 0 %}
            //自由模式
            $("#page-input").on("focus",function () {
                $(this).val("");
                console.log("cs")
            });
        {% else %}
            //日常模式
            $("#page-input").on("focus",function () {
                //$(this).val("");
                console.log("cs")
            });
        {% endif %}
        $("#document_text").on("focus",function () {
            //$(this).val("");
            console.log("cs")
        });




        //图片放大
        $("body").on("click", ".pictureEnlarge", function () {
            var src_img = $(this).attr("sta_url");
            if(src_img==undefined || src_img=="" || src_img==null){
                //console.log("console.log(src_img);");
                //console.log(src_img);
                src_img = $(this).attr("src");
            }
            var ImageData_ = $.photoBrowser({
                items: [
                    {
                        image: src_img,
                        caption: ""
                    }
                ]
            });
            ImageData_.open();
        });

    </script>

    <!--- 邀请 -->
    <script>

        var extra_earn=Number({{ extra_earn |default:'0'}});
        //extra_earn=1000;
        if(extra_earn==0){
            $(".invite_num_plus").hide();
        }else{
            $(".invite_num_plus").show();
            $("#invite_num_plus_1").text("额外");
            $("#invite_num_plus_1_1").text("+"+extra_earn);
        }

        var invite_num=Number({{ invite_num }});

        if(invite_num>10){
            $("#invite_num_plus_2").text('X500%');
        }else if(invite_num==0){
            //$("#invite_num_plus_2").text('X1000%');
            $("#invite_num_plus_2").hide();
        }else {
            var invite_num_text=(1+invite_num*0.5)*100;
            $("#invite_num_plus_2").text('X'+invite_num_text+'%');
        }

    </script>

    <!-- 图片上传 改用 base64 -->
    <script>

        var file_filepath='';
        var file_refpath='';
        var file_filepatharrayObject=[];
        var file_refpatharrayObject=[];

        var img_Number=0;
        //图片转成base64 方法
        $("#read_comment").click(function () {
            //img_Number=0;
            $(".mask_on__container").show();
            $("#upload-popup").popup();
            $("body").addClass("popup-open");
        });
        //图片转成base64 方法

        function ImgToBase64(file, maxLen, callBack) {
            var img = new Image();

            var reader = new FileReader();//读取客户端上的文件
            reader.onload = function () {
                var url = reader.result;//读取到的文件内容.这个属性只在读取操作完成之后才有效,并且数据的格式取决于读取操作是由哪个方法发起的.所以必须使用reader.onload，
                img.src = url;//reader读取的文件内容是base64,利用这个url就能实现上传前预览图片
            };
            img.onload = function () {
                //生成比例
                var width = img.width, height = img.height;
                //计算缩放比例
                var rate = 1;
                if (width >= height) {
                    if (width > maxLen) {
                        rate = maxLen / width;
                    }
                } else {
                    if (height > maxLen) {
                        rate = maxLen / height;
                    }
                };
                img.width = width * rate;
                img.height = height * rate;
                //生成canvas
                var canvas = document.createElement("canvas");
                var ctx = canvas.getContext("2d");
                canvas.width = img.width;
                canvas.height = img.height;
                ctx.drawImage(img, 0, 0, img.width, img.height);
                var base64 = canvas.toDataURL('image/jpeg', 0.9);
                callBack(base64);
            };

            reader.readAsDataURL(file);
        }

        //点击移除图片
        //移除 图片
        function case_img_remove(uid,file_filepath__,file_refpath__) {
            console.log("移除 图片");
            file_filepatharrayObject.remove(file_filepath__);
            file_refpatharrayObject.remove(file_refpath__);
            console.log(file_refpatharrayObject);
            console.log(file_filepatharrayObject);
            newCaseSubmit();
            $(".img___"+uid).detach();
        }

        function newCaseSubmit() {
            console.log(file_refpatharrayObject.length);
            var len=file_refpatharrayObject.length;
            if (len < 3){
                $(".uploaderInput_input").css("display","block");
            }else{
                $(".uploaderInput_input").hide();
            }
            //console.log(file_refpatharrayObject);

            file_filepath = file_filepatharrayObject.join(",");
            file_refpath = file_refpatharrayObject.join(",");

            console.log(file_filepath);
            console.log(file_refpath);
            $.hideLoading();
        }


        $(function () {
            //input 上传图片
        /* */
            var sourceNode = document.getElementById("sourceNode");

            function random_string(len) {
                len = len || 32;
                var chars = 'ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678';
                var maxPos = chars.length;
                var pwd = '';
                for (i = 0; i < len; i++) {
                    pwd += chars.charAt(Math.floor(Math.random() * maxPos));
                }
                return pwd;
            }

           $("input[accept='image/*']").change(function () {
               $.showLoading();
               $(".weui-toast_content").text("图片获取中...");
                var file = $(this)[0].files[0];//获取input file控件选择的文件
                ImgToBase64(file, 1080, function (base64) {
                    console.log(base64);
                    //$("#result").attr("src",base64)
                    //预览页面上预留一个img元素，载入base64
                    //设定宽高，不然会自动按照压缩过的图片宽高设定，有可能超出预想的范围。
        　　　　　　　　　　　//直接利用ajax上传base64到服务器，完毕
                    setTimeout(function () {

                       $.ajax({
                               type: "post",
                               url: "/api/get_base",
                               data: {
                                   "activity":"running/",
                                   "base64": base64
                               },
                               success: function (res) {
                                   if(res.status == 200){
                                       img_Number=img_Number+1;
                                       var file_filepath__=res.file_filepath;
                                       file_filepatharrayObject.push(file_filepath__);
                                       var file_refpath__ =res.file_refpath;
                                       file_refpatharrayObject.push(file_refpath__);
                                       var random_name=random_string(16);

                                        var clonedNode = sourceNode.cloneNode(true); // 克隆节点
                                        sourceNode.parentNode.appendChild(clonedNode); // 在父节点插入克隆的节点

                                        clonedNode.setAttribute("id", "clone_" + random_name); // 修改一下id 值，避免id 重复
                                        $targetNode = $('#clone_' + random_name);

                                        clonedNode.setAttribute("class","clone_remove uploaderInput_box img___" +random_name);
                                        var aa='float: left;width: 30%;margin-left:1%;height: 60px;background-size: cover; background: url('+file_refpath__+')  center;background-size: cover;background-repeat: no-repeat;position: relative;';
                                        clonedNode.setAttribute("style",aa);

                                        $targetNode.css("backgroundImage","url("+file_refpath__+")");

                                        $targetNode.find(".news-item__content-img ").attr("src",file_refpath__);
                                        var onck="case_img_remove('"+random_name+"','"+file_filepath__+"','"+file_refpath__+"')";
                                        $targetNode.find(".img_remove").attr("onclick", onck);

                                       newCaseSubmit();

                                       setTimeout(function () {
                                           $.hideLoading();
                                       }, 500);
                                   }else{
                                       $.hideLoading();
                                       $.toast("获取失败！请重试上传图片", "cancel",function () {

                                       });
                                   }
                               },
                               error:function(res){
                                   $.hideLoading();
                                   $.toast("请重试上传图片", "cancel",function () {

                                   });
                                   console.log(res)
                               }
                           });
                    }, 1000);
                });

           });

           Array.prototype.indexOf = function(val) {
            for (var i = 0; i < this.length; i++) {
                if (this[i] == val) return i;
            }
            return -1;
        };

        Array.prototype.remove = function(val) {
            var index = this.indexOf(val);
            if (index > -1) {
                this.splice(index, 1);
            }
        };

        function newCaseSubmit() {
            console.log(file_refpatharrayObject.length);
            var len=file_refpatharrayObject.length;
            if (len < 3){
                $(".uploaderInput_input").css("display","block");
            }else{
                $(".uploaderInput_input").hide();
            }
            //console.log(file_refpatharrayObject);

            file_filepath = file_filepatharrayObject.join(",");
            file_refpath = file_refpatharrayObject.join(",");

            console.log(file_filepath);
            console.log(file_refpath);
            $.hideLoading();
        }

           //点击上传 按钮
            $("#reading-confirm-btn").on("click",function() {

                $.showLoading();
                $(".weui-toast_content").text("提交中...");
                var document_val=$("#document_text").val();

                 /*  输入说明 控制长度 和 特殊字符 */
                if(document_val.length==0){

                }else{
                    if (document_val.length > 200) {
                        $.hideLoading();
                        $.toptip("不能超过200字", "error");
                        $("#document_text").focus();
                        return
                    }

                    var pattern = /^[a-zA-Z-—=+。，!！￥$#、？：“”`~@%^&*(){}【】[ ;|；,.'‘’\d\u4E00-\u9FA5]+$/i;
                    /*
                    if (pattern.test(document_val)){
                    } else{
                        $.toptip('含有符号，请重试！', 'error',function () {
                            $("#document_text").focus();
                        });

                        $.hideLoading();
                        return
                    }
                    */

                }

                /*  判断上传 图片是否为空 */
                console.log(file_refpath);
                if (file_refpath == ''||file_refpath==null || file_refpath==undefined ) {
                    $.hideLoading();
                    $.toast("请先上传图片", "cancel");
                    //$.hideLoading();
                    return;
                }

                /*  判断打卡 时间 */
                if (time_1()) {
                    console.log("可以打卡")
                }else {
                    $.hideLoading();
                    $.toast("打卡时间已过", "cancel");
                    //$.hideLoading();
                    return;
                }

                /*  获取公里数 */
                {% if goal.goal_type == 0 %}
                    var distance = parseFloat($("#page-input").val());
                    if(distance>99.99){
                        $.hideLoading();
                        $.toast("请填写有效的公里数", "cancel");
                        //$.hideLoading();
                        return;
                    }
                {% else %}
                    var distance = parseFloat($("#page-input").val());
                    if(distance>99.99){
                        $.hideLoading();
                        $.toast("请填写有效的公里数", "cancel");
                        //$.hideLoading();
                        return;
                    }
                {% endif %}

                if(isNaN(distance)){
                    $.hideLoading();
                    $.toast("请填写有效的公里数", "cancel");
                    //$.hideLoading();
                    return;
                }

                /*  获取goal_id  */
                var goal_id =$("#goal-id__get").html();
                /*  ajax 提交 */

                var Num=$(this).attr("Num");
                //alert(distance);
                if(Num=="2"){
                    var punch_id=$("#reading-confirm-btn").attr("punch_id");
                    reopenedUpload(distance,document_val,goal_id,punch_id)
                }else{
                    upload(distance,document_val,goal_id);
                }

                console.log("file_filepath:"+file_filepath);
                console.log("file_refpath:"+file_refpath);

                console.log("distance:"+distance);
                console.log("document_val:"+document_val);
                console.log("goal_id:"+goal_id);
                //$(".weui-toast_content").text("打卡中...");
                //ajax end

            });
            //点击上传 结束
            //打卡
            function upload(distance,document_val,goal_id) {
                console.log(document_val);
                console.log(file_filepath);
                console.log(file_refpath);
                $.ajax({
                    type: "post",
                    url: "/api/running_sign_in",
                    data:{
                        "file_filepath":file_filepath,
                        "file_refpath":file_refpath,
                        "distance": distance,
                        "document":document_val,
                        "goal":goal_id,
                        "random":c
                    },
                    success: function (res) {
                        $(".click_col").attr("sta","123");

                        $(".two").css("transform","rotateY(180deg)");
                        $(".container").css("transform","rotateY(180deg)");
                        $(".two").css("opacity","1");
                        //$(".two").css("zIndex","99999999999999999999999");
                        $(".two").show();
                        $(".one").css("opacity","0");
                        $.hideLoading();
                        $.toast("上传成功", "success", function () {
                            //window.location.reload();
                        });
                    },
                    error:function(res){
                        $.hideLoading();
                        //console.log(res)
                    }
                });
            }


            //重新上传
            function reopenedUpload(distance,document_val,goal_id,punch_id) {

                console.log(document_val);
                console.log(file_filepath);
                console.log(file_refpath);
                $.ajax({
                    type: "post",
                    url: "/api/upload_again",
                    data:{
                        "file_filepath":file_filepath,
                        "file_refpath":file_refpath,
                        "distance": distance,
                        "document":document_val,
                        "goal":goal_id,
                        "punch_id":punch_id,
                        "random":c
                    },
                    success: function (res) {
                        //console.log(res.status);
                        $(".click_col").attr("sta","123");
                        //$(".two").css("zIndex","99999999999999999999999");
                        $(".two").css("transform","rotateY(180deg)");
                        $(".container").css("transform","rotateY(180deg)");
                        $(".two").css("opacity","1");
                        //$(".two").css("zIndex","99999999999999999999999");
                        $(".two").show();
                        $(".one").css("opacity","0");
                        $.hideLoading();

                        $.toast("上传成功", "success", function () {
                            //window.location.reload();
                        });

                    },
                    error:function(res){
                        $.hideLoading();
                        //console.log("失败");
                        //console.log(res)
                    }
                });
            }


            function time_1() {
                var e = new Date ();
                var H=e.getHours();
                var m=e.getMinutes();
                console.log(H);
                console.log(m);
                if(H== 23 && m > 45){
                    return false
                }else if(H == 0 && m <15){
                    return false
                }else{
                    return true
                }
            }

        });
    </script>

    <!--  翻转 卡片-->
    <script>
        var c = checkNum();
        function checkNum(){
            var random = getRandom(1, 51);
            //console.log(random);
            return random;
        }

        function getRandom(min, max){
            var r = Math.random() * (max - min);
            var re = Math.round(r + min);
            re = Math.max(Math.min(re, max), min);
            return re;
        }
        $(function () {
            var colHeight = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;
            var colWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
            $(".two").width(colWidth*0.75);
            $(".two").height(colWidth*0.75*1.65);


            //console.log(c);
            $("#goal_img").attr("src", "/static/images/goal/" + c + "@2x.png");
            $("#goal_img").css("opacity", 1);
            var da__ = new Date ();
            var now_d = da__.getDate();
            var now_y=da__.getFullYear();
            var now_m=da__.getMonth();
            var now_m_y=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Spt","Oct","Nov","Dec");
            now_m=now_m_y[now_m];
            //now_m =(now_m<10 ? "0"+now_m:now_m);
            $(".now_d").text(now_d);
            $(".now_m").text(now_m);
            $(".now_y").text(now_y);
        });

        $(".click_col").click(function () {
            //console.log("111111111111111");
            //关闭弹窗
            var sta=String($(this).attr("sta"));
            //console.log(sta);
            if(sta== '0'){
                $(".container").css("transform","rotateY(0deg)");
                $(".one").css("opacity","1");
                $(".two").hide();
                //$(".two").css("zIndex","106");
                $(".two").css("opacity","0");
                $(".mask_on__container").hide();
                $.closePopup();
                $("#upload-popup").hide();
                $("body").removeClass("popup-open");
            }else if(sta=='123'){
                //$(".two").css("zIndex","106");
                setTimeout(function(){
                    window.location.reload();
                },500);
            }
        })


    </script>



</body>

</html>